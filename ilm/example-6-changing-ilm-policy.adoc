---
permalink: ilm/example-6-changing-ilm-policy.html 
sidebar: sidebar 
keywords: change ILM policy, example ILM policy, information lifecycle policy example 
summary: データ保護を変更する必要がある場合、または新しいサイトを追加する場合は、新しい ILM ポリシーを作成してアクティブ化できます。 
---
= 例6: ILMポリシーを変更する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
データ保護を変更する必要がある場合、または新しいサイトを追加する場合は、新しい ILM ポリシーを作成してアクティブ化できます。

ポリシーを変更する前に、ILM 配置の変更がStorageGRIDシステムの全体的なパフォーマンスに一時的にどのような影響を与えるかを理解する必要があります。

この例では、拡張により新しいStorageGRIDサイトが追加され、新しいサイトにデータを保存するには新しいアクティブな ILM ポリシーを実装する必要があります。新しいアクティブポリシーを実装するには、まずlink:creating-ilm-policy.html["ポリシーを作成する"]。その後はlink:../ilm/creating-ilm-policy.html#simulate-ilm-policy["シミュレートする"]その後link:../ilm/creating-ilm-policy.html#activate-ilm-policy["アクティブ化"]新しいポリシー。


CAUTION: 次の ILM ルールとポリシーは例にすぎません。 ILM ルールを構成する方法は多数あります。新しいポリシーを有効にする前に、ポリシーをシミュレートして、コンテンツの損失を防ぐためにポリシーが意図したとおりに機能することを確認します。



== ILMポリシーの変更がパフォーマンスに与える影響

新しい ILM ポリシーをアクティブ化すると、特に新しいポリシーの配置指示により多数の既存オブジェクトを新しい場所に移動する必要がある場合は、 StorageGRIDシステムのパフォーマンスが一時的に影響を受ける可能性があります。

新しい ILM ポリシーをアクティブ化すると、 StorageGRID はそれを使用して、既存のオブジェクトと新しく取り込まれたオブジェクトを含むすべてのオブジェクトを管理します。新しい ILM ポリシーをアクティブ化する前に、既存の複製および消去コード化されたオブジェクトの配置の変更を確認してください。既存のオブジェクトの場所を変更すると、新しい配置が評価され実装されるときに一時的なリソースの問題が発生する可能性があります。

新しいILMポリシーが既存の複製および消去コード化されたオブジェクトの配置に影響を与えないようにするには、link:create-ilm-rule-enter-details.html#use-advanced-filters-in-ilm-rules["取り込み時間フィルターを使用してILMルールを作成する"] 。たとえば、「*取り込み時刻が <日付と時刻> 以降である*」と指定すると、新しいルールは指定された日付と時刻以降に取り込まれたオブジェクトにのみ適用されます。

StorageGRID のパフォーマンスに一時的に影響を与える可能性のある ILM ポリシーの変更の種類は次のとおりです。

* 既存の消去コード化オブジェクトに別の消去コード化プロファイルを適用します。
+

NOTE: StorageGRID は、各消去コーディング プロファイルを一意と見なし、新しいプロファイルが使用されるときに消去コーディング フラグメントを再利用しません。

* 既存のオブジェクトに必要なコピーの種類を変更します。たとえば、複製されたオブジェクトの大部分を消去コード化されたオブジェクトに変換します。
* 既存のオブジェクトのコピーを完全に別の場所に移動する。たとえば、大量のオブジェクトをクラウド ストレージ プールまたはリモート サイト間で移動するなど。




== 例6のアクティブILMポリシー: 2つのサイトでのデータ保護

この例では、アクティブな ILM ポリシーは当初 2 サイトのStorageGRIDシステム用に設計されており、2 つの ILM ルールを使用しています。

image::../media/policy_6_active_policy.png[ILMポリシーの例6アクティブポリシー]

この ILM ポリシーでは、テナント A に属するオブジェクトは単一のサイトで 2+1 消去コーディングによって保護され、他のすべてのテナントに属するオブジェクトは 2 コピー レプリケーションを使用して 2 つのサイト間で保護されます。



=== ルール1: テナントAのワンサイト消去符号化

[cols="1a,2a"]
|===
| ルールの定義 | 値の例 


 a| 
ルール名
 a| 
テナントAのワンサイト消去符号化



 a| 
テナント アカウント
 a| 
テナントA



 a| 
ストレージ プール
 a| 
サイト1



 a| 
配置
 a| 
サイト1の2+1消去符号化は0日目から永久に

|===


=== ルール2: 他のテナントのための2サイトレプリケーション

[cols="1a,2a"]
|===
| ルールの定義 | 値の例 


 a| 
ルール名
 a| 
他のテナント向けの2サイトレプリケーション



 a| 
テナント アカウント
 a| 
無視する



 a| 
ストレージ プール
 a| 
サイト1とサイト2



 a| 
配置
 a| 
0 日目から永久に複製された 2 つのコピー: サイト 1 に 1 つのコピー、サイト 2 に 1 つのコピー。

|===


== ILMポリシー例6: 3つのサイトでのデータ保護

この例では、ILM ポリシーが 3 サイトのStorageGRIDシステムの新しいポリシーに置き換えられています。

新しいサイトを追加するための拡張を実行した後、グリッド管理者は 2 つの新しいストレージ プールを作成しました。1 つはサイト 3 のストレージ プール、もう 1 つは 3 つのサイトすべてを含むストレージ プールです (すべてのストレージ ノードのデフォルトのストレージ プールとは異なります)。次に、管理者は 3 つのサイトすべてでデータを保護するように設計された 2 つの新しい ILM ルールと 1 つの新しい ILM ポリシーを作成しました。

この新しい ILM ポリシーを有効にすると、テナント A に属するオブジェクトは 3 つのサイトで 2+1 消去コーディングによって保護され、他のテナントに属するオブジェクト (およびテナント A に属する小さなオブジェクト) は 3 つのコピー レプリケーションを使用して 3 つのサイト間で保護されます。



=== ルール1: テナントAの3サイト消去符号化

[cols="1a,2a"]
|===
| ルールの定義 | 値の例 


 a| 
ルール名
 a| 
テナントAの3サイト消去符号化



 a| 
テナント アカウント
 a| 
テナントA



 a| 
ストレージ プール
 a| 
3つのサイトすべて（サイト1、サイト2、サイト3を含む）



 a| 
配置
 a| 
3 つのサイトすべてで 0 日目から永久に 2+1 消去符号化を実施

|===


=== ルール2: 他のテナントのための3サイトレプリケーション

[cols="1a,2a"]
|===
| ルールの定義 | 値の例 


 a| 
ルール名
 a| 
他のテナント向けの3サイトレプリケーション



 a| 
テナント アカウント
 a| 
無視する



 a| 
ストレージ プール
 a| 
サイト1、サイト2、サイト3



 a| 
配置
 a| 
0 日目から永久に複製された 3 つのコピー: サイト 1 に 1 つのコピー、サイト 2 に 1 つのコピー、サイト 3 に 1 つのコピー。

|===


== 例6のILMポリシーの有効化

新しい ILM ポリシーをアクティブ化すると、新しいルールまたは更新されたルールの配置指示に基づいて、既存のオブジェクトが新しい場所に移動されたり、既存のオブジェクトの新しいオブジェクト コピーが作成されたりする場合があります。


CAUTION: ILM ポリシーにエラーがあると、回復不能なデータ損失が発生する可能性があります。ポリシーをアクティブ化する前に慎重に確認してシミュレートし、意図したとおりに機能することを確認します。


CAUTION: 新しい ILM ポリシーをアクティブ化すると、 StorageGRID はそれを使用して、既存のオブジェクトと新しく取り込まれたオブジェクトを含むすべてのオブジェクトを管理します。新しい ILM ポリシーをアクティブ化する前に、既存の複製および消去コード化されたオブジェクトの配置の変更を確認してください。既存のオブジェクトの場所を変更すると、新しい配置が評価され実装されるときに一時的なリソースの問題が発生する可能性があります。



=== 消去符号化命令が変更されると何が起こるか

この例の現在アクティブな ILM ポリシーでは、テナント A に属するオブジェクトは、サイト 1 で 2+1 消去コーディングを使用して保護されています。新しい ILM ポリシーでは、テナント A に属するオブジェクトは、サイト 1、2、3 で 2+1 消去コーディングを使用して保護されます。

新しい ILM ポリシーがアクティブ化されると、次の ILM 操作が行われます。

* テナント A によって取り込まれた新しいオブジェクトは 2 つのデータ フラグメントに分割され、1 つのパリティ フラグメントが追加されます。次に、3 つのフラグメントはそれぞれ異なる場所に保存されます。
* テナント A に属する既存のオブジェクトは、進行中の ILM スキャン プロセス中に再評価されます。  ILM 配置指示では新しい消去符号化プロファイルが使用されるため、完全に新しい消去符号化フラグメントが作成され、3 つのサイトに配布されます。
+

NOTE: サイト 1 の既存の 2+1 フラグメントは再利用されません。  StorageGRID は、各消去コーディング プロファイルを一意と見なし、新しいプロファイルが使用されるときに消去コーディング フラグメントを再利用しません。





=== 複製指示が変更されると何が起こるか

この例の現在アクティブな ILM ポリシーでは、他のテナントに属するオブジェクトは、サイト 1 と 2 のストレージ プール内の 2 つの複製されたコピーを使用して保護されます。新しい ILM ポリシーでは、サイト 1、2、3 のストレージ プール内の 3 つの複製されたコピーを使用して、他のテナントに属するオブジェクトが保護されます。

新しい ILM ポリシーがアクティブ化されると、次の ILM 操作が行われます。

* テナント A 以外のテナントが新しいオブジェクトを取り込むと、 StorageGRID は3 つのコピーを作成し、各サイトに 1 つのコピーを保存します。
* これらの他のテナントに属する既存のオブジェクトは、進行中の ILM スキャン プロセス中に再評価されます。サイト 1 とサイト 2 の既存のオブジェクト コピーは新しい ILM ルールのレプリケーション要件を引き続き満たすため、 StorageGRID はサイト 3 のオブジェクトの新しいコピーを 1 つだけ作成する必要があります。




=== このポリシーを有効にした場合のパフォーマンスへの影響

この例の ILM ポリシーがアクティブ化されると、このStorageGRIDシステムの全体的なパフォーマンスが一時的に影響を受けます。テナント A の既存のオブジェクトに対して新しい消去コード化フラグメントを作成し、他のテナントの既存のオブジェクトに対してサイト 3 に新しい複製コピーを作成するには、通常よりも高いレベルのグリッド リソースが必要になります。

ILM ポリシーの変更の結果、クライアントの読み取りおよび書き込み要求の待機時間が一時的に通常よりも長くなる可能性があります。配置命令がグリッド全体に完全に実装されると、レイテンシは通常のレベルに戻ります。

新しい ILM ポリシーをアクティブ化するときにリソースの問題を回避するには、多数の既存オブジェクトの場所を変更する可能性のあるルールで、取り込み時間の詳細フィルタを使用できます。既存のオブジェクトが不必要に移動されないように、取り込み時間を新しいポリシーが有効になるおおよその時刻以上に設定します。


NOTE: ILM ポリシーの変更後にオブジェクトの処理速度を遅くしたり、速くしたりする必要がある場合は、テクニカル サポートにお問い合わせください。
