---
permalink: ilm/using-multiple-storage-pools-for-cross-site-replication.html 
sidebar: sidebar 
keywords: site-loss protection, cross-site replication, storage pools 
summary: StorageGRID の展開に複数のサイトが含まれている場合は、適切に構成されたストレージ プールでレプリケーションと消去コーディングを使用して、サイト損失保護を有効にすることができます。 
---
= サイト損失保護を有効にする
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
StorageGRID の展開に複数のサイトが含まれている場合は、適切に構成されたストレージ プールでレプリケーションと消去コーディングを使用して、サイト損失保護を有効にすることができます。

レプリケーションと消去コーディングには、異なるストレージ プール構成が必要です。

* サイト損失保護のためにレプリケーションを使用するには、 StorageGRID のインストール中に自動的に作成されるサイト固有のストレージ プールを使用します。次にILMルールを作成しますlink:create-ilm-rule-define-placements.html["配置手順"]各オブジェクトの 1 つのコピーが各サイトに配置されるように、複数のストレージ プールを指定します。
* サイト損失防止のために消失訂正符号を使用するには、link:guidelines-for-creating-storage-pools.html#guidelines-for-storage-pools-used-for-erasure-coded-copies["複数のサイトで構成されるストレージプールを作成する"] 。次に、複数のサイトと利用可能な消去コーディング スキーマで構成される 1 つのストレージ プールを使用する ILM ルールを作成します。



CAUTION: サイト損失保護のためにStorageGRID導入を構成する際には、以下の影響も考慮する必要があります。link:data-protection-options-for-ingest.html["取り込みオプション"]そしてlink:../s3/consistency-controls.html["一貫性"]。



== レプリケーションの例

デフォルトでは、 StorageGRID のインストール中にサイトごとに 1 つのストレージ プールが作成されます。 1 つのサイトのみで構成されるストレージ プールを使用すると、サイト損失保護のためにレプリケーションを使用する ILM ルールを構成できます。この例では、

* ストレージプール1にはサイト1が含まれています
* ストレージプール2にはサイト2が含まれます
* ILM ルールには 2 つの配置が含まれます。
+
** サイト1に1つのコピーを複製してオブジェクトを保存する
** サイト2に1つのコピーを複製してオブジェクトを保存する




ILM ルールの配置:

image::../media/ilm_replication_at_2_sites.png[2つのサイトにそれぞれ1つのコピーを複製する]

image::../media/ilm_replication_make_2_copies_2_pools_2_sites.png[2つのサイトにそれぞれ1つのコピーを作成 - サイト固有のストレージプール]

1 つのサイトが失われた場合、オブジェクトのコピーは他のサイトで利用できます。



== 消失訂正符号の例

ストレージ プールごとに複数のサイトで構成されるストレージ プールを使用すると、サイト損失保護のために消去コーディングを使用する ILM ルールを構成できます。この例では、

* ストレージプール1にはサイト1から3が含まれます
* ILMルールには1つの配置が含まれています: 3つのサイトを含むストレージプール1に4+2 ECスキームを使用して消去符号化によってオブジェクトを保存します。


ILM ルールの配置:

image::../media/ilm_erasure_coding_site_loss_protection_4+2.png[EC 1 ストレージプール 9 ストレージノード 3 サイト]

この例では、

* ILM ルールでは、4+2 消去符号化方式が使用されます。
* 各オブジェクトは 4 つの等しいデータ フラグメントに分割され、オブジェクト データから 2 つのパリティ フラグメントが計算されます。
* 6 つのフラグメントはそれぞれ、3 つのデータ センター サイトにまたがる異なるノードに保存され、ノード障害やサイト損失に対するデータ保護を提供します。



NOTE: 消去コーディングは、2 つのサイトを除く任意の数のサイトを含むストレージ プールで許可されます。

4+2 消失訂正符号化方式を使用した ILM ルール:

image::../media/ec_three_sites_4_plus_2_site_loss_example_template.png[3つのサイトにわたって4+2 EC方式を使用して、消失訂正符号化によってオブジェクトを保存します。]

1 つのサイトが失われても、データは回復可能です。

image::../media/ec_three_sites_4_plus_2_site_loss_example.png[消失訂正符号 4+2 EC スキーム 1 サイトが失われました]
