---
permalink: ilm/what-ilm-rule-is.html 
sidebar: sidebar 
keywords: what is information lifecycle rule, ilm rule 
summary: 'オブジェクトを管理するには、情報ライフサイクル管理 (ILM) ルールのセットを作成し、それを ILM ポリシーに整理します。' 
---
= ILMルールを使用してオブジェクトを管理する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
オブジェクトを管理するには、情報ライフサイクル管理 (ILM) ルールのセットを作成し、それらを ILM ポリシーに整理します。

システムに取り込まれた各オブジェクトは、アクティブ ポリシーに照らして評価されます。ポリシー内のルールがオブジェクトのメタデータと一致する場合、ルール内の指示によって、 StorageGRID がそのオブジェクトをコピーして保存するために実行するアクションが決定されます。


NOTE: オブジェクト メタデータは ILM ルールによって管理されません。代わりに、オブジェクト メタデータは、メタデータ ストアと呼ばれる Cassandra データベースに保存されます。データの損失を防ぐために、オブジェクト メタデータの 3 つのコピーが各サイトで自動的に維持されます。



== ILMルールの要素

ILM ルールには 3 つの要素があります。

* *フィルタリング基準*: ルールの基本フィルタと詳細フィルタは、ルールが適用されるオブジェクトを定義します。オブジェクトがすべてのフィルターに一致する場合、 StorageGRID はルールを適用し、ルールの配置指示で指定されたオブジェクトのコピーを作成します。
* *配置指示*: ルールの配置指示は、オブジェクトのコピーの数、タイプ、および場所を定義します。各ルールには、時間の経過に伴ってオブジェクトのコピーの数、タイプ、場所を変更するための一連の配置命令を含めることができます。  1 つの配置の期間が終了すると、次の配置の指示が次の ILM 評価によって自動的に適用されます。
* *取り込み動作*: ルールの取り込み動作により、ルールによってフィルタリングされたオブジェクトが取り込まれるとき (S3 クライアントがオブジェクトをグリッドに保存するとき) にどのように保護されるかを選択できます。




== ILMルールフィルタリング

ILM ルールを作成するときは、ルールが適用されるオブジェクトを識別するためのフィルターを指定します。

最も単純なケースでは、ルールはフィルターを使用しない場合があります。フィルターを使用しないルールはすべてのオブジェクトに適用されるため、ILM ポリシーの最後の (デフォルトの) ルールにする必要があります。デフォルトのルールは、別のルールのフィルターに一致しないオブジェクトの保存手順を提供します。

* 基本フィルターを使用すると、大規模で個別のオブジェクト グループに異なるルールを適用できます。これらのフィルターを使用すると、特定のテナント アカウント、特定の S3 バケット、またはその両方にルールを適用できます。
+
基本フィルターを使用すると、多数のオブジェクトにさまざまなルールを簡単に適用できます。たとえば、会社の財務記録は規制要件を満たすために保存する必要がある場合があり、一方でマーケティング部門のデータは日常業務を円滑に進めるために保存する必要がある場合があります。各部門に個別のテナント アカウントを作成するか、異なる部門のデータを個別の S3 バケットに分離した後、すべての財務レコードに適用される 1 つのルールと、すべてのマーケティング データに適用される 2 番目のルールを簡単に作成できます。

* 高度なフィルターによりきめ細かな制御が可能になります。次のオブジェクト プロパティに基づいてオブジェクトを選択するためのフィルターを作成できます。
+
** 取り込み時間
** 最終アクセス時間
** オブジェクト名（キー）の全部または一部
** 場所の制約（S3のみ）
** オブジェクトのサイズ
** ユーザーメタデータ
** オブジェクトタグ（S3のみ）




非常に具体的な基準でオブジェクトをフィルタリングできます。たとえば、病院の画像部門で保存されたオブジェクトは、保存から 30 日未満であれば頻繁に使用され、それ以降はほとんど使用されなくなる可能性があります。一方、患者の診察情報を含むオブジェクトは、医療ネットワーク本部の請求部門にコピーする必要がある場合があります。オブジェクト名、サイズ、S3 オブジェクト タグ、またはその他の関連する基準に基づいて各オブジェクト タイプを識別するフィルターを作成し、各オブジェクト セットを適切に保存するための個別のルールを作成できます。

必要に応じて、単一のルール内でフィルターを組み合わせることができます。たとえば、マーケティング部門ではベンダーのレコードとは別の方法で大きな画像ファイルを保存する必要がある場合があり、一方、人事部門では特定の地域の人事レコードとポリシー情報を一元的に保存する必要がある場合があります。この場合、テナント アカウントでフィルター処理して各部門のレコードを分離するルールを作成し、各ルールでフィルターを使用して、ルールが適用される特定のオブジェクトの種類を識別することができます。



== ILMルールの配置手順

配置命令は、オブジェクト データが保存される場所、時期、方法を決定します。 ILM ルールには、1 つ以上の配置指示を含めることができます。各配置指示は単一の期間に適用されます。

配置指示を作成するときは、次の操作を行います。

* まず、配置指示の開始時刻を決定する参照時刻を指定します。参照時間は、オブジェクトが取り込まれたとき、オブジェクトがアクセスされたとき、バージョン管理されたオブジェクトが最新でなくなったとき、またはユーザー定義の時間である可能性があります。
* 次に、基準時間を基準にして配置を適用するタイミングを指定します。たとえば、配置は、オブジェクトが取り込まれた時点を基準として、0 日目から 365 日間継続する場合があります。
* 最後に、コピーの種類 (レプリケーションまたは消去コーディング) とコピーを保存する場所を指定します。たとえば、複製された 2 つのコピーを 2 つの異なるサイトに保存するとします。


各ルールでは、単一の期間に複数の配置を定義したり、異なる期間に異なる配置を定義したりできます。

* 単一の期間中にオブジェクトを複数の場所に配置するには、「*他のタイプまたは場所を追加*」を選択して、その期間に複数の行を追加します。
* 異なる期間の異なる場所にオブジェクトを配置するには、「別の期間を追加」を選択して次の期間を追加します。次に、期間内の 1 行以上を指定します。


この例では、ILM ルールの作成ウィザードの配置の定義ページの 2 つの配置指示を示します。

image::../media/ilm_rule_multiple_placements_in_single_time_period.png[グリッド マネージャーの ILM 配置画面]

最初の配置指示image:../media/icon_number_1.png["アイコン番号1"]初年度は2つのラインがあります:

* 最初の行は、2 つのデータ センター サイトに 2 つの複製されたオブジェクトのコピーを作成します。
* 2 行目は、すべてのデータセンター サイトを使用して 6+3 消去コード化コピーを作成します。


2番目の配置指示image:../media/icon_number_2.png["アイコン番号1"]1 年後に 2 つのコピーを作成し、それらのコピーを永久に保存します。

ルールの配置指示のセットを定義するときは、少なくとも 1 つの配置指示が 0 日目から始まり、定義した期間の間にギャップがないこと、および最後の配置指示が永久にまたはオブジェクトのコピーが不要になるまで継続することを確認する必要があります。

ルール内の各期間が終了すると、次の期間のコンテンツ配置指示が適用されます。新しいオブジェクトのコピーが作成され、不要なコピーは削除されます。



== ILMルール取り込み動作

取り込み動作は、オブジェクトのコピーをルールの指示に従ってすぐに配置するか、中間コピーを作成して配置指示を後で適用するかを制御します。  ILM ルールでは次の取り込み動作を使用できます。

* *バランス*: StorageGRID は取り込み時に ILM ルールで指定されたすべてのコピーを作成しようとします。これが不可能な場合は、中間コピーが作成され、クライアントに成功が返されます。  ILM ルールで指定されたコピーは、可能な場合に作成されます。
* *厳密*: クライアントに成功が返される前に、ILM ルールで指定されたすべてのコピーを作成する必要があります。
* *デュアルコミット*: StorageGRID はオブジェクトの中間コピーを直ちに作成し、クライアントに成功を返します。  ILM ルールで指定されたコピーは、可能な場合に作成されます。


.関連情報
* link:data-protection-options-for-ingest.html["取り込みオプション"]
* link:advantages-disadvantages-of-ingest-options.html["取り込みオプションの利点、欠点、制限"]
* link:../s3/consistency-controls.html#how-consistency-controls-and-ILM-rules-interact["一貫性と ILM ルールがどのように相互作用してデータ保護に影響を与えるか"]




== ILMルールの例

たとえば、ILM ルールでは次のように指定できます。

* テナント A に属するオブジェクトにのみ適用します。
* これらのオブジェクトの複製コピーを 2 つ作成し、各コピーを別のサイトに保存します。
* 2 つのコピーを「永久に」保持します。つまり、 StorageGRID はそれらを自動的に削除しません。代わりに、 StorageGRID は、クライアントの削除要求によって削除されるか、バケットのライフサイクルの有効期限が切れるまで、これらのオブジェクトを保持します。
* 取り込み動作にはバランス オプションを使用します。必要な両方のコピーをすぐに作成できない場合を除き、テナント A がオブジェクトをStorageGRIDに保存するとすぐ、2 つのサイトへの配置指示が適用されます。
+
たとえば、テナント A がオブジェクトを保存するときにサイト 2 にアクセスできない場合、 StorageGRID はサイト 1 のストレージ ノードに 2 つの中間コピーを作成します。サイト 2 が利用可能になるとすぐに、 StorageGRID はそのサイトで必要なコピーを作成します。



.関連情報
* link:what-storage-pool-is.html["ストレージプールとは"]
* link:what-cloud-storage-pool-is.html["クラウドストレージプールとは"]

