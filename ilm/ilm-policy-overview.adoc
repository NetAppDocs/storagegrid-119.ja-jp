---
permalink: ilm/ilm-policy-overview.html 
sidebar: sidebar 
keywords: ILM policy, information lifecycle policy considerations 
summary: '情報ライフサイクル管理 (ILM) ポリシーは、 StorageGRIDシステムが時間の経過とともにオブジェクト データを管理する方法を決定する ILM ルールの順序付けられたセットです。' 
---
= ILMポリシーを使用する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
情報ライフサイクル管理 (ILM) ポリシーは、 StorageGRIDシステムが時間の経過とともにオブジェクト データを管理する方法を決定する ILM ルールの順序付けられたセットです。


CAUTION: ILM ポリシーが誤って構成されていると、回復不可能なデータ損失が発生する可能性があります。  ILM ポリシーをアクティブ化する前に、ILM ポリシーとその ILM ルールを慎重に確認し、ILM ポリシーをシミュレートします。  ILM ポリシーが意図したとおりに機能することを常に確認してください。



== デフォルトのILMポリシー

StorageGRIDをインストールしてサイトを追加すると、次のようにデフォルトの ILM ポリシーが自動的に作成されます。

* グリッドに 1 つのサイトが含まれている場合、デフォルト ポリシーには、そのサイトの各オブジェクトの 2 つのコピーを複製するデフォルト ルールが含まれます。
* グリッドに複数のサイトが含まれている場合、デフォルトのルールにより、各サイトの各オブジェクトのコピーが 1 つ複製されます。


デフォルトのポリシーがストレージ要件を満たしていない場合は、独自のルールとポリシーを作成できます。見るlink:what-ilm-rule-is.html["ILMルールを作成する"]そしてlink:creating-ilm-policy.html["ILMポリシーを作成する"]。



== アクティブな ILM ポリシーは 1 つですか、それとも複数ですか?

一度に 1 つ以上の ILM ポリシーをアクティブにすることができます。



=== 一つの政策

グリッドで、テナント固有およびバケット固有のルールがほとんどないシンプルなデータ保護スキームを使用する場合は、アクティブな ILM ポリシーを 1 つだけ使用します。  ILM ルールには、さまざまなバケットまたはテナントを管理するためのフィルターを含めることができます。

image::../media/ilm-policies-single.png[単一のILMポリシー図]

ポリシーが 1 つしかなく、テナントの要件が変更された場合は、新しい ILM ポリシーを作成するか、既存のポリシーを複製して変更を適用し、シミュレートしてから、新しい ILM ポリシーをアクティブ化する必要があります。  ILM ポリシーを変更すると、オブジェクトの移動に数日かかり、システム遅延が発生する可能性があります。



=== 複数のポリシー

テナントに異なるサービス品質オプションを提供するために、一度に複数のポリシーをアクティブにすることができます。各ポリシーでは、特定のテナント、S3 バケット、オブジェクトを管理できます。特定のテナントまたはオブジェクトのセットに 1 つのポリシーを適用または変更しても、他のテナントおよびオブジェクトに適用されているポリシーは影響を受けません。

ILMポリシータグ:: テナントがバケットごとに複数のデータ保護ポリシーを簡単に切り替えられるようにするには、_ILM ポリシー タグ_ を使用して複数の ILM ポリシーを使用します。各 ILM ポリシーをタグに割り当て、テナントがバケットにタグを付けて、そのバケットにポリシーを適用します。  ILM ポリシー タグは S3 バケットにのみ設定できます。
+
--
たとえば、「Gold」、「Silver」、「Bronze」という名前の 3 つのタグがあるとします。 ILM ポリシーがオブジェクトを保存する期間と場所に基づいて、各タグに ILM ポリシーを割り当てることができます。テナントはバケットにタグを付けることで、使用するポリシーを選択できます。  Gold タグが付けられたバケットは Gold ポリシーによって管理され、Gold レベルのデータ保護とパフォーマンスが提供されます。

--
デフォルトのILMポリシータグ:: StorageGRIDをインストールすると、デフォルトの ILM ポリシー タグが自動的に作成されます。各グリッドには、デフォルト タグに割り当てられたアクティブなポリシーが 1 つ必要です。デフォルトのポリシーは、タグが付いていない S3 バケットに適用されます。


image::../media/ilm-policies-tags-conceptual.png[複数の ILM ポリシー図]



== ILM ポリシーはオブジェクトをどのように評価しますか?

アクティブな ILM ポリシーは、オブジェクトの配置、期間、およびデータ保護を制御します。

クライアントがオブジェクトをStorageGRIDに保存すると、そのオブジェクトは次のようにポリシー内の順序付けられた ILM ルール セットに対して評価されます。

. ポリシーの最初のルールのフィルターがオブジェクトと一致する場合、オブジェクトはそのルールの取り込み動作に従って取り込まれ、そのルールの配置指示に従って保存されます。
. 最初のルールのフィルターがオブジェクトと一致しない場合、一致が見つかるまで、オブジェクトはポリシー内の後続の各ルールに対して評価されます。
. オブジェクトに一致するルールがない場合、ポリシー内のデフォルト ルールの取り込み動作と配置手順が適用されます。デフォルト ルールは、ポリシー内の最後のルールです。デフォルトのルールは、すべてのテナント、すべての S3 バケット、およびすべてのオブジェクト バージョンに適用する必要があり、高度なフィルターは使用できません。




== ILMポリシーの例

たとえば、ILM ポリシーには、次の内容を指定する 3 つの ILM ルールを含めることができます。

* *ルール1: テナントAの複製コピー*
+
** テナント A に属するすべてのオブジェクトを一致させます。
** これらのオブジェクトを 3 つの複製コピーとして 3 つのサイトに保存します。
** 他のテナントに属するオブジェクトはルール 1 に一致しないため、ルール 2 に対して評価されます。


* *ルール2: 1 MBを超えるオブジェクトの消失訂正符号*
+
** 他のテナントのすべてのオブジェクトと一致しますが、1 MB を超える場合のみです。これらの大きなオブジェクトは、6+3 消失訂正符号化を使用して 3 つのサイトに保存されます。
** 1 MB 以下のオブジェクトには一致しないため、これらのオブジェクトはルール 3 に対して評価されます。


* *ルール3: 2つのコピー、2つのデータセンター* (デフォルト)
+
** ポリシー内の最後のデフォルトのルールです。フィルターは使用しません。
** ルール 1 またはルール 2 に一致しないすべてのオブジェクト (テナント A に属さない 1 MB 以下のオブジェクト) の複製コピーを 2 つ作成します。




image::../media/ilm_policy_and_rules.png[ILMポリシーとルール]



== アクティブ ポリシーと非アクティブ ポリシーとは何ですか?

すべてのStorageGRIDシステムには、少なくとも 1 つのアクティブな ILM ポリシーが必要です。複数のアクティブな ILM ポリシーを使用する場合は、ILM ポリシー タグを作成し、各タグにポリシーを割り当てます。その後、テナントは S3 バケットにタグを適用します。デフォルト ポリシーは、ポリシー タグが割り当てられていないバケット内のすべてのオブジェクトに適用されます。

ILM ポリシーを初めて作成するときは、1 つ以上の ILM ルールを選択し、特定の順序で並べます。ポリシーをシミュレートして動作を確認した後、ポリシーをアクティブ化します。

1 つの ILM ポリシーをアクティブ化すると、 StorageGRID はそのポリシーを使用して、既存のオブジェクトと新しく取り込まれたオブジェクトを含むすべてのオブジェクトを管理します。新しいポリシーの ILM ルールが実装されると、既存のオブジェクトが新しい場所に移動される可能性があります。

一度に複数の ILM ポリシーをアクティブ化し、テナントが S3 バケットにポリシー タグを適用すると、各バケット内のオブジェクトはタグに割り当てられたポリシーに従って管理されます。

StorageGRIDシステムは、アクティブ化または非アクティブ化されたポリシーの履歴を追跡します。



== ILMポリシー作成時の考慮事項

* テスト システムでは、システム提供のポリシー (ベースライン 2 コピー ポリシー) のみを使用します。  StorageGRID 11.6 以前では、このポリシーの Make 2 Copies ルールは、すべてのサイトが含まれる All Storage Nodes ストレージ プールを使用します。  StorageGRIDシステムに複数のサイトがある場合、オブジェクトの 2 つのコピーが同じサイトに配置されることがあります。
+

NOTE: すべてのストレージ ノード ストレージ プールは、 StorageGRID 11.6 以前のインストール中に自動的に作成されます。  StorageGRIDの新しいバージョンにアップグレードする場合でも、「すべてのストレージ ノード」プールは引き続き存在します。  StorageGRID 11.7 以降を新規インストールする場合、すべてのストレージ ノード プールは作成されません。

* 新しいポリシーを設計するときは、グリッドに取り込まれる可能性のあるさまざまな種類のオブジェクトをすべて考慮してください。必要に応じてこれらのオブジェクトを一致させて配置するためのルールがポリシーに含まれていることを確認します。
* ILM ポリシーはできる限りシンプルに保ちます。これにより、時間の経過とともにStorageGRIDシステムに変更が加えられた場合に、オブジェクト データが意図したとおりに保護されないという潜在的に危険な状況を回避できます。
* ポリシー内のルールが正しい順序になっていることを確認してください。ポリシーを有効にすると、新規オブジェクトと既存オブジェクトは、上から順にリストされた順序でルールによって評価されます。たとえば、ポリシーの最初のルールがオブジェクトに一致する場合、そのオブジェクトは他のルールによって評価されません。
* すべての ILM ポリシーの最後のルールはデフォルトの ILM ルールであり、フィルターは使用できません。オブジェクトが別のルールと一致しなかった場合、デフォルトのルールによってそのオブジェクトが配置される場所と保持期間が制御されます。
* 新しいポリシーをアクティブ化する前に、ポリシーによって既存のオブジェクトの配置にどのような変更が加えられるかを確認してください。既存のオブジェクトの場所を変更すると、新しい配置が評価され実装されるときに一時的なリソースの問題が発生する可能性があります。

