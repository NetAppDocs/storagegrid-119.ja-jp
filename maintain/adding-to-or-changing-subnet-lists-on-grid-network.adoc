---
permalink: maintain/adding-to-or-changing-subnet-lists-on-grid-network.html 
sidebar: sidebar 
keywords: storagegrid, subnet list, grid network 
summary: IP 変更ツールを使用して、グリッド ネットワーク上のサブネットを追加または変更できます。 
---
= グリッドネットワーク上のサブネットリストを追加または変更する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
IP 変更ツールを使用して、グリッド ネットワーク上のサブネットを追加または変更できます。

.開始する前に
* あなたは `Passwords.txt`ファイル。


グリッド ネットワーク サブネット リストでサブネットを追加、削除、または変更できます。変更はグリッド内のすべてのノードのルーティングに影響します。


NOTE: グリッド ネットワーク サブネット リストのみを変更する場合は、グリッド マネージャを使用してネットワーク構成を追加または変更します。それ以外の場合、ネットワーク構成の問題によりグリッド マネージャーにアクセスできない場合、またはグリッド ネットワーク ルーティングの変更とその他のネットワークの変更を同時に実行している場合は、IP 変更ツールを使用します。

[NOTE]
====
どのノードのグリッド ネットワーク、管理ネットワーク、またはクライアント ネットワークにも、次の IPv4 アドレスを含むサブネットを使用しないでください。

* 192,168,130,101
* 192,168,131,101
* 192,168,130,102
* 192,168,131,102
* 198.51.100.2
* 198.51.100.4


たとえば、どのノードのグリッド ネットワーク、管理ネットワーク、またはクライアント ネットワークにも次のサブネット範囲を使用しないでください。

* 192.168.130.0/24 は、このサブネット範囲に IP アドレス 192.168.130.101 と 192.168.130.102 が含まれているためです。
* 192.168.131.0/24 は、このサブネット範囲に IP アドレス 192.168.131.101 と 192.168.131.102 が含まれているためです。
* 198.51.100.0/24 は、このサブネット範囲に IP アドレス 198.51.100.2 と 198.51.100.4 が含まれているためです。


====
.手順
. プライマリ管理ノードにログインします。
+
.. 次のコマンドを入力します。 `ssh admin@_primary_Admin_Node_IP_`
.. 記載されているパスワードを入力してください `Passwords.txt`ファイル。
.. ルートに切り替えるには、次のコマンドを入力します。 `su -`
.. 記載されているパスワードを入力してください `Passwords.txt`ファイル。


+
ルートとしてログインすると、プロンプトは `$`に `#`。

. 次のコマンドを入力して、IP 変更ツールを起動します。 `change-ip`
. プロンプトでプロビジョニング パスフレーズを入力します。
+
メインメニューが表示されます。

+
image::../media/change_ip_tool_main_menu.png[IP変更ツールのウェルカム画面を示すスクリーンショット]

. メイン メニューで、グリッド ネットワークのサブネットを編集するオプション (オプション *4*) を選択します。
+

NOTE: グリッド ネットワーク サブネット リストへの変更はグリッド全体に適用されます。

. 次のいずれかを選択します。
+
--
** 次のコマンドを入力してサブネットを追加します。 `add CIDR`
** 次のコマンドを入力してサブネットを削除します。 `del CIDR`
** 次のコマンドを入力してサブネットのリストを設定します。 `set CIDR`


--
+
--

NOTE: すべてのコマンドでは、次の形式を使用して複数のアドレスを入力できます。 `add CIDR, CIDR`

例： `add 172.14.0.0/16, 172.15.0.0/16, 172.16.0.0/16`


TIP: 「上矢印」を使用して以前に入力した値を現在の入力プロンプトに呼び出し、必要に応じて編集することで、必要な入力量を減らすことができます。

以下の入力例は、グリッド ネットワーク サブネット リストのサブネットの設定を示しています。

image::../media/change_ip_tool_gnsl_sample_input.gif[周囲のテキストで説明されているスクリーンショット]

--
. 準備ができたら、*q* と入力してメイン メニュー画面に戻ります。変更はクリアまたは適用されるまで保持されます。
. 次のいずれかを選択します。
+
** オプション *5* を選択すると、変更された項目のみが表示されるように分離された出力で編集内容が表示されます。以下の出力例に示すように、変更は緑色 (追加) または赤色 (削除) で強調表示されます。
+
image::../media/change_ip_tool_gnsl_sample_output.gif[周囲のテキストで説明されているスクリーンショット]

** 完全な構成を表示する出力に編集内容を表示するには、オプション *6* を選択します。変更は緑色 (追加) または赤色 (削除) で強調表示されます。
+

NOTE: 特定のコマンド ライン インターフェイスでは、追加や削除が取り消し線形式を使用して表示される場合があります。



. すべてのステージングされた変更を検証するには、オプション *7* を選択します。
+
この検証により、重複するサブネットの使用など、グリッド、管理、およびクライアント ネットワークのルールが遵守されていることが確認されます。

. 必要に応じて、オプション *8* を選択して、段階的に行われたすべての変更を保存し、後で戻って変更を続行します。
+
このオプションを使用すると、適用されていない変更を失うことなく、IP 変更ツールを終了し、後で再度起動することができます。

. 次のいずれかを実行します。
+
** 新しいネットワーク構成を保存または適用せずにすべての変更をクリアする場合は、オプション *9* を選択します。
** 変更を適用して新しいネットワーク構成をプロビジョニングする準備ができたら、オプション *10* を選択します。プロビジョニング中、次の出力例に示すように、更新が適用されると出力にステータスが表示されます。
+
[listing]
----
Generating new grid networking description file...

Running provisioning...

Updating grid network configuration on Name
----


. グリッド ネットワークの変更時にオプション *10* を選択した場合は、次のいずれかのオプションを選択します。
+
** *apply*: 変更を直ちに適用し、必要に応じて各ノードを自動的に再起動します。
+
新しいネットワーク構成が外部の変更なしに古いネットワーク構成と同時に機能する場合は、完全に自動化された構成変更のために *apply* オプションを使用できます。

** *stage*: 次回ノードを再起動したときに変更を適用します。
+
新しいネットワーク構成を機能させるために物理または仮想ネットワーク構成の変更が必要な場合は、*stage* オプションを使用して、影響を受けるノードをシャットダウンし、必要な物理ネットワーク変更を行って、影響を受けるノードを再起動する必要があります。

+

NOTE: *stage* オプションを使用する場合は、中断を最小限に抑えるために、ステージング後できるだけ早くノードを再起動してください。

** *キャンセル*: 現時点ではネットワークの変更は行わないでください。
+
提案された変更にノードの再起動が必要であることを認識していなかった場合は、ユーザーへの影響を最小限に抑えるために変更を延期することができます。  *キャンセル*を選択するとメイン メニューに戻り、変更内容が保存されるので、後で適用することができます。



+
変更を適用またはステージングすると、グリッド構成の変更の結果として新しいリカバリ パッケージが生成されます。

. エラーのために構成が停止した場合は、次のオプションが利用できます。
+
** IP 変更手順を終了してメイン メニューに戻るには、*a* と入力します。
** 失敗した操作を再試行するには、「*r*」と入力します。
** 次の操作を続行するには、*c* と入力します。
+
失敗した操作は、メイン メニューからオプション *10* (変更の適用) を選択して後で再試行できます。すべての操作が正常に完了するまで、IP 変更手順は完了しません。

** 手動で介入する必要があり（たとえば、ノードを再起動するなど）、ツールが失敗したと判断したアクションが実際には正常に完了したと確信できる場合は、「*f*」と入力して成功としてマークし、次の操作に進みます。


. グリッド マネージャーから新しいリカバリ パッケージをダウンロードします。
+
.. *メンテナンス* > *システム* > *回復パッケージ*を選択します。
.. プロビジョニング パスフレーズを入力します。


+

CAUTION: リカバリ パッケージ ファイルには、 StorageGRIDシステムからデータを取得するために使用できる暗号化キーとパスワードが含まれているため、セキュリティ保護する必要があります。


