---
permalink: maintain/changing-nodes-network-configuration.html 
sidebar: sidebar 
keywords: storagegrid, network configuration, node network configuration 
summary: IP 変更ツールを使用して、1 つ以上のノードのネットワーク構成を変更できます。グリッド ネットワークの構成を変更したり、管理ネットワークやクライアント ネットワークを追加、変更、削除したりできます。 
---
= ノードネットワーク構成を変更する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
IP 変更ツールを使用して、1 つ以上のノードのネットワーク構成を変更できます。グリッド ネットワークの構成を変更したり、管理ネットワークやクライアント ネットワークを追加、変更、削除したりできます。

.開始する前に
あなたは `Passwords.txt`ファイル。

.タスク概要
*Linux:* グリッド ノードを管理ネットワークまたはクライアント ネットワークに初めて追加する場合、以前にノード構成ファイルで ADMIN_NETWORK_TARGET または CLIENT_NETWORK_TARGET を構成していなかったときは、ここで構成する必要があります。

Linux オペレーティング システム用のStorageGRIDインストール手順を参照してください。

* link:../rhel/index.html["Red Hat Enterprise LinuxにStorageGRIDをインストールする"]
* link:../ubuntu/index.html["UbuntuまたはDebianにStorageGRIDをインストールする"]


*アプライアンス:* StorageGRIDアプライアンスでは、初期インストール時にStorageGRIDアプライアンス インストーラでクライアント ネットワークまたは管理ネットワークが設定されていない場合、IP 変更ツールのみを使用してネットワークを追加することはできません。まず、 https://docs.netapp.com/us-en/storagegrid-appliances/commonhardware/placing-appliance-into-maintenance-mode.html["アプライアンスをメンテナンスモードにする"^]リンクを設定し、アプライアンスを通常の動作モードに戻し、IP 変更ツールを使用してネットワーク構成を変更します。参照 https://docs.netapp.com/us-en/storagegrid-appliances/installconfig/configuring-network-links.html["ネットワークリンクを構成する手順"^]。

任意のネットワーク上の 1 つ以上のノードの IP アドレス、サブネット マスク、ゲートウェイ、または MTU 値を変更できます。

クライアント ネットワークまたは管理者ネットワークからノードを追加または削除することもできます。

* ノードにそのネットワークの IP アドレス/サブネット マスクを追加することで、クライアント ネットワークまたは管理ネットワークにノードを追加できます。
* クライアント ネットワークまたは管理ネットワークからノードを削除するには、そのネットワーク上のノードの IP アドレス/サブネット マスクを削除します。
+
ノードをグリッド ネットワークから削除することはできません。




NOTE: IP アドレスのスワップは許可されていません。グリッド ノード間で IP アドレスを交換する必要がある場合は、一時的な中間 IP アドレスを使用する必要があります。


NOTE: StorageGRIDシステムでシングル サインオン (SSO) が有効になっていて、管理ノードの IP アドレスを変更する場合は、管理ノードの IP アドレス (推奨されている完全修飾ドメイン名ではなく) を使用して設定された証明書利用者信頼が無効になることに注意してください。ノードにサインインできなくなります。IP アドレスを変更した直後に、Active Directory フェデレーション サービス (AD FS) 内のノードの証明書利用者信頼を新しい IP アドレスで更新または再構成する必要があります。説明書をご覧くださいlink:../admin/configuring-sso.html["SSOの設定"]。


NOTE: IP 変更ツールを使用してネットワークに加えた変更は、 StorageGRIDアプライアンスのインストーラ ファームウェアに伝播されます。こうすることで、アプライアンスにStorageGRIDソフトウェアを再インストールしたり、アプライアンスをメンテナンス モードにしたりした場合でも、ネットワーク構成は正しくなります。

.手順
. プライマリ管理ノードにログインします。
+
.. 次のコマンドを入力します。 `ssh admin@_primary_Admin_Node_IP_`
.. 記載されているパスワードを入力してください `Passwords.txt`ファイル。
.. ルートに切り替えるには、次のコマンドを入力します。 `su -`
.. 記載されているパスワードを入力してください `Passwords.txt`ファイル。


+
ルートとしてログインすると、プロンプトは `$`に `#`。

. 次のコマンドを入力して、IP 変更ツールを起動します。 `change-ip`
. プロンプトでプロビジョニング パスフレーズを入力します。
+
メインメニューが表示されます。

+
image::../media/change_ip_tool_main_menu.png[IP変更ツールのウェルカム画面を示すスクリーンショット]

. 必要に応じて *1* を選択して、更新するノードを選択します。次に、次のいずれかのオプションを選択します。
+
** *1*: 単一ノード - 名前で選択
** *2*: 単一ノード - サイト別に選択し、次に名前別に選択
** *3*: 単一ノード - 現在のIPで選択
** *4*: サイト内のすべてのノード
** *5*: グリッド内のすべてのノード
+
*注:* すべてのノードを更新する場合は、「すべて」を選択したままにしておきます。



+
選択すると、メイン メニューが表示され、*選択したノード* フィールドが選択内容を反映して更新されます。以降のすべてのアクションは、表示されているノードに対してのみ実行されます。

. メイン メニューでオプション *2* を選択し、選択したノードの IP/マスク、ゲートウェイ、および MTU 情報を編集します。
+
.. 変更を加えるネットワークを選択します。
+
--
*** *1*: グリッドネットワーク
*** *2*: 管理ネットワーク
*** *3*: クライアントネットワーク
*** *4*: すべてのネットワーク


--
+
--
選択すると、プロンプトにノード名、ネットワーク名 (グリッド、管理者、またはクライアント)、データ タイプ (IP/マスク、ゲートウェイ、または MTU)、および現在の値が表示されます。

DHCP が設定されたインターフェースの IP アドレス、プレフィックス長、ゲートウェイ、または MTU を編集すると、インターフェースは静的に変更されます。  DHCP によって設定されたインターフェースを変更することを選択すると、インターフェースが静的に変更されることを通知する警告が表示されます。

インターフェースの設定 `fixed`編集できません。

--
.. 新しい値を設定するには、現在の値に表示されている形式で入力します。
.. 現在の値を変更しない場合は、*Enter* を押します。
.. データ型が `IP/mask`、*d* または *0.0.0.0/0* と入力すると、ノードから管理ネットワークまたはクライアント ネットワークを削除できます。
.. 変更したいすべてのノードを編集した後、*q* と入力してメイン メニューに戻ります。
+
変更はクリアまたは適用されるまで保持されます。



. 次のいずれかのオプションを選択して変更内容を確認します。
+
** *5*: 変更された項目のみを表示するように分離された出力内の編集を表示します。変更は、出力例に示すように、緑色 (追加) または赤色 (削除) で強調表示されます。
+
image::../media/change_ip_tool_edit_ip_mask_sample_output.png[周囲のテキストで説明されているスクリーンショット]

** *6*: 完全な構成を表示する出力に編集内容を表示します。変更は緑色 (追加) または赤色 (削除) で強調表示されます。
+

NOTE: 特定のコマンド ライン インターフェイスでは、追加や削除が取り消し線形式を使用して表示される場合があります。適切な表示は、必要な VT100 エスケープ シーケンスをサポートしている端末クライアントに依存します。



. すべての変更を検証するには、オプション *7* を選択します。
+
この検証により、重複するサブネットを使用しないなどのグリッド、管理、およびクライアント ネットワークのルールに違反していないことが確認されます。

+
この例では、検証でエラーが返されました。

+
image::../media/change_ip_tool_validate_sample_error_messages.gif[周囲のテキストで説明されているスクリーンショット]

+
この例では、検証は合格しました。

+
image::../media/change_ip_tool_validate_sample_passed_messages.gif[周囲のテキストで説明されているスクリーンショット]

. 検証に合格したら、次のいずれかのオプションを選択します。
+
** *8*: 適用されていない変更を保存します。
+
このオプションを使用すると、適用されていない変更を失うことなく、IP 変更ツールを終了し、後で再度起動することができます。

** *10*: 新しいネットワーク構成を適用します。


. オプション*10*を選択した場合は、次のいずれかのオプションを選択します。
+
** *apply*: 変更を直ちに適用し、必要に応じて各ノードを自動的に再起動します。
+
新しいネットワーク構成で物理的なネットワークの変更が必要ない場合は、「適用」を選択して変更をすぐに適用できます。必要に応じて、ノードは自動的に再起動されます。再起動が必要なノードが表示されます。

** *stage*: 次にノードを手動で再起動するときに変更を適用します。
+
新しいネットワーク構成を機能させるために物理または仮想ネットワーク構成の変更が必要な場合は、*stage* オプションを使用して、影響を受けるノードをシャットダウンし、必要な物理ネットワーク変更を行って、影響を受けるノードを再起動する必要があります。最初にこれらのネットワーク変更を行わずに「適用」を選択すると、通常、変更は失敗します。

+

NOTE: *stage* オプションを使用する場合は、中断を最小限に抑えるために、ステージング後できるだけ早くノードを再起動する必要があります。

** *キャンセル*: 現時点ではネットワークの変更は行わないでください。
+
提案された変更にノードの再起動が必要であることを認識していなかった場合は、ユーザーへの影響を最小限に抑えるために変更を延期することができます。  *キャンセル*を選択するとメイン メニューに戻り、変更内容が保存されるので、後で適用することができます。

+
*適用*または*ステージ*を選択すると、新しいネットワーク構成ファイルが生成され、プロビジョニングが実行され、ノードが新しい作業情報で更新されます。

+
プロビジョニング中、更新が適用されると、出力にステータスが表示されます。

+
[listing]
----
Generating new grid networking description file...

Running provisioning...

Updating grid network configuration on Name
----


+
変更を適用またはステージングすると、グリッド構成の変更の結果として新しいリカバリ パッケージが生成されます。

. *ステージ*を選択した場合は、プロビジョニングが完了したら次の手順に従います。
+
.. 必要な物理または仮想ネットワークの変更を行います。
+
*物理ネットワークの変更*: 必要な物理ネットワークの変更を行い、必要に応じてノードを安全にシャットダウンします。

+
*Linux*: ノードを管理ネットワークまたはクライアントネットワークに初めて追加する場合は、以下の説明に従ってインターフェースを追加したことを確認してください。link:linux-adding-interfaces-to-existing-node.html["Linux: 既存のノードにインターフェースを追加する"] 。

.. 影響を受けるノードを再起動します。


. 変更が完了したら、*0* を選択して IP 変更ツールを終了します。
. グリッド マネージャーから新しいリカバリ パッケージをダウンロードします。
+
.. *メンテナンス* > *システム* > *回復パッケージ*を選択します。
.. プロビジョニング パスフレーズを入力します。



