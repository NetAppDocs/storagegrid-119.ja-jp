= 接続をテストし、設定を保存します
:allow-uri-read: 


. *ID フェデレーションを有効にする* を選択します。
. LDAP サービス タイプ セクションで、構成する LDAP サービスのタイプを選択します。
+
image::../media/ldap_service_type.png[LDAP サービス タイプ オプションが表示された ID フェデレーション ページ]

+
Oracle Directory Server を使用する LDAP サーバーの値を構成するには、「*その他*」を選択します。

. *その他*を選択した場合は、LDAP 属性セクションのフィールドに入力します。次の手順に進みます。
+
** *ユーザーの一意の名前*: LDAP ユーザーの一意の識別子を含む属性の名前。この属性は、 `sAMAccountName` Active Directoryおよび `uid`OpenLDAP 用。Oracle Directory Serverを構成する場合は、次のように入力します。 `uid` 。
** *ユーザー UUID*: LDAP ユーザーの永続的な一意の識別子を含む属性の名前。この属性は、 `objectGUID` Active Directoryおよび `entryUUID`OpenLDAP 用。Oracle Directory Serverを構成する場合は、次のように入力します。 `nsuniqueid` 。指定された属性の各ユーザーの値は、16 バイト形式または文字列形式の 32 桁の 16 進数である必要があります。ハイフンは無視されます。
** *グループの一意の名前*: LDAP グループの一意の識別子を含む属性の名前。この属性は、 `sAMAccountName` Active Directoryおよび `cn`OpenLDAP 用。Oracle Directory Serverを構成する場合は、次のように入力します。 `cn` 。
** *グループ UUID*: LDAP グループの永続的な一意の識別子を含む属性の名前。この属性は、 `objectGUID` Active Directoryおよび `entryUUID`OpenLDAP 用。Oracle Directory Serverを構成する場合は、次のように入力します。 `nsuniqueid` 。指定された属性の各グループの値は、16 バイト形式または文字列形式の 32 桁の 16 進数である必要があります。ハイフンは無視されます。


. すべての LDAP サービス タイプについて、[LDAP サーバーの構成] セクションで必要な LDAP サーバーおよびネットワーク接続情報を入力します。
+
** *ホスト名*: LDAP サーバーの完全修飾ドメイン名 (FQDN) または IP アドレス。
** *ポート*: LDAP サーバーに接続するために使用されるポート。
+

NOTE: STARTTLS のデフォルト ポートは 389 で、LDAPS のデフォルト ポートは 636 です。ただし、ファイアウォールが正しく設定されている限り、どのポートでも使用できます。

** *ユーザー名*: LDAP サーバーに接続するユーザーの識別名 (DN) の完全パス。
+
Active Directory の場合は、ダウンレベル ログオン名またはユーザー プリンシパル名を指定することもできます。

+
指定されたユーザーには、グループとユーザーを一覧表示し、次の属性にアクセスする権限が必要です。

+
*** `sAMAccountName`または `uid`
*** `objectGUID`、 `entryUUID` 、 または `nsuniqueid`
*** `cn`
*** `memberOf`または `isMemberOf`
*** *アクティブディレクトリ*: `objectSid` 、 `primaryGroupID` 、 `userAccountControl` 、 そして `userPrincipalName`
*** *アズール*: `accountEnabled`そして `userPrincipalName`


** *パスワード*: ユーザー名に関連付けられたパスワード。
+

NOTE: 将来パスワードを変更する場合は、このページで更新する必要があります。

** *グループ ベース DN*: グループを検索する LDAP サブツリーの識別名 (DN) の完全パス。  Active Directory の例 (下記) では、識別名がベース DN (DC=storagegrid、DC=example、DC=com) を基準とするすべてのグループをフェデレーション グループとして使用できます。
+

NOTE: *グループの一意の名前*の値は、それが属する *グループ ベース DN* 内で一意である必要があります。

** *ユーザー ベース DN*: ユーザーを検索する LDAP サブツリーの識別名 (DN) の完全パス。
+

NOTE: *ユーザー固有名* の値は、それが属する *ユーザー ベース DN* 内で一意である必要があります。

** *バインド ユーザー名の形式* (オプション): パターンを自動的に決定できない場合にStorageGRIDが使用するデフォルトのユーザー名パターン。
+
StorageGRID がサービス アカウントにバインドできない場合にユーザーがサインインできるように、*バインド ユーザー名形式* を指定することをお勧めします。

+
次のいずれかのパターンを入力します。

+
*** *UserPrincipalName パターン (Active Directory および Azure)*: `[USERNAME]@_example_.com`
*** *ダウンレベル ログオン名パターン (Active Directory および Azure)*: `_example_\[USERNAME]`
*** *識別名パターン*: `CN=[USERNAME],CN=Users,DC=_example_,DC=com`
+
*[USERNAME]* を記載どおりに入力してください。





. [トランスポート層セキュリティ (TLS)] セクションで、セキュリティ設定を選択します。
+
** *STARTTLS を使用する*: STARTTLS を使用して、LDAP サーバーとの通信を保護します。これは、Active Directory、OpenLDAP、またはその他の場合に推奨されるオプションですが、このオプションは Azure ではサポートされていません。
** *LDAPS を使用する*: LDAPS (LDAP over SSL) オプションは、TLS を使用して LDAP サーバーへの接続を確立します。Azure の場合はこのオプションを選択する必要があります。
** *TLS を使用しない*: StorageGRIDシステムと LDAP サーバー間のネットワーク トラフィックは保護されません。このオプションは Azure ではサポートされていません。
+

NOTE: Active Directory サーバーが LDAP 署名を強制している場合、「TLS を使用しない」オプションの使用はサポートされません。STARTTLS または LDAPS を使用する必要があります。



. STARTTLS または LDAPS を選択した場合は、接続を保護するために使用する証明書を選択します。
+
** *オペレーティング システムの CA 証明書を使用する*: オペレーティング システムにインストールされているデフォルトの Grid CA 証明書を使用して、接続を保護します。
** *カスタム CA 証明書を使用する*: カスタム セキュリティ証明書を使用します。
+
この設定を選択した場合は、カスタム セキュリティ証明書をコピーして CA 証明書テキスト ボックスに貼り付けます。







=== 接続をテストし、設定を保存します

すべての値を入力した後、構成を保存する前に接続をテストする必要があります。  StorageGRID は、LDAP サーバーの接続設定と、指定された場合はバインド ユーザー名の形式を検証します。

.手順
. *テスト接続*を選択します。
. バインドユーザー名の形式を指定しなかった場合:
+
** 接続設定が有効な場合は、「テスト接続が成功しました」というメッセージが表示されます。設定を保存するには、[*保存*] を選択します。
** 接続設定が無効な場合、「テスト接続を確立できませんでした」というメッセージが表示されます。 *閉じる*を選択します。次に、問題を解決して、再度接続をテストします。


. バインド ユーザー名形式を指定した場合は、有効なフェデレーション ユーザーのユーザー名とパスワードを入力します。
+
たとえば、独自のユーザー名とパスワードを入力します。ユーザー名には @ や / などの特殊文字を含めないでください。

+
image::../media/identity_federation_test_connection.png[バインドユーザー名の形式を検証するための ID フェデレーション プロンプト]

+
** 接続設定が有効な場合は、「テスト接続が成功しました」というメッセージが表示されます。設定を保存するには、[*保存*] を選択します。
** 接続設定、バインド ユーザー名の形式、またはテスト ユーザー名とパスワードが無効な場合は、エラー メッセージが表示されます。問題を解決して、再度接続をテストしてください。



