---
permalink: troubleshoot/troubleshoot-low-watermark-alert.html 
sidebar: sidebar 
keywords: troubleshoot low soft read-only watermark override alert, optimized watermarks 
summary: ストレージ ボリュームのウォーターマークにカスタム値を使用する場合は、低読み取り専用ウォーターマーク オーバーライド アラートを解決する必要がある場合があります。可能であれば、最適化された値を使用するようにシステムを更新する必要があります。 
---
= 低読み取り専用ウォーターマーク上書きアラートのトラブルシューティング
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ストレージ ボリュームのウォーターマークにカスタム値を使用する場合は、*読み取り専用の低いウォーターマークのオーバーライド* アラートを解決する必要がある場合があります。可能であれば、最適化された値を使用するようにシステムを更新する必要があります。

以前のリリースでは、3つのlink:../admin/what-storage-volume-watermarks-are.html["ストレージボリュームのウォーターマーク"]グローバル設定であり、すべてのストレージ ノード上のすべてのストレージ ボリュームに同じ値が適用されます。  StorageGRID 11.6 以降では、ソフトウェアはストレージ ノードのサイズとボリュームの相対容量に基づいて、各ストレージ ボリュームのこれらのウォーターマークを最適化できます。

StorageGRID 11.6 以降にアップグレードすると、次のいずれかに該当しない限り、最適化された読み取り専用および読み取り/書き込みウォーターマークがすべてのストレージ ボリュームに自動的に適用されます。

* システムの容量が近づいており、最適化されたウォーターマークが適用されると新しいデータを受け入れることができなくなります。この場合、 StorageGRID はウォーターマーク設定を変更しません。
* 以前に、ストレージ ボリュームのウォーターマークのいずれかをカスタム値に設定しました。 StorageGRID は、カスタム ウォーターマーク設定を最適化された値で上書きしません。ただし、ストレージ ボリュームのソフト読み取り専用ウォーターマークのカスタム値が小さすぎる場合、 StorageGRID は*読み取り専用ウォーターマークの低いオーバーライド* アラートをトリガーする可能性があります。




== 警告を理解する

ストレージ ボリュームのウォーターマークにカスタム値を使用すると、1 つ以上のストレージ ノードに対して *読み取り専用ウォーターマークの低いオーバーライド* アラートがトリガーされる可能性があります。

アラートの各インスタンスは、ストレージ ボリュームのソフト読み取り専用ウォーターマークのカスタム値が、そのストレージ ノードの最小最適化値よりも小さいことを示します。カスタム設定を引き続き使用すると、ストレージ ノードが安全に読み取り専用状態に移行する前に、空き容量が極端に少なくなる可能性があります。ノードの容量がいっぱいになると、一部のストレージ ボリュームがアクセス不能になる (自動的にマウント解除される) 場合があります。

たとえば、以前にストレージ ボリュームのソフト読み取り専用ウォーターマークを 5 GB に設定したとします。ここで、 StorageGRID がストレージ ノード A の 4 つのストレージ ボリュームに対して次の最適化された値を計算したとします。

[cols="2a,2a"]
|===


 a| 
第0巻
 a| 
12 GB



 a| 
第1巻
 a| 
12 GB



 a| 
第2巻
 a| 
11 GB



 a| 
第3巻
 a| 
15 GB

|===
カスタム ウォーターマーク (5 GB) がそのノード内のすべてのボリュームの最小最適化値 (11 GB) よりも小さいため、ストレージ ノード A に対して *読み取り専用ウォーターマーク オーバーライドの低さ* アラートがトリガーされます。カスタム設定を引き続き使用すると、ノードが安全に読み取り専用状態に移行する前に、ノードの空き容量が極端に少なくなる可能性があります。



== アラートを解決する

1 つ以上の *Low read-only watermark override* アラートがトリガーされた場合は、次の手順に従ってください。現在カスタムのウォーターマーク設定を使用しており、アラートがトリガーされていない場合でも最適化された設定の使用を開始する場合にも、これらの手順を使用できます。

.開始する前に
* StorageGRID 11.6 以降へのアップグレードが完了しました。
* グリッドマネージャにサインインするには、link:../admin/web-browser-requirements.html["サポートされているウェブブラウザ"] 。
* あなたはlink:../admin/admin-group-permissions.html["ルートアクセス権限"]。


.タスク概要
カスタム ウォーターマーク設定を新しいウォーターマーク オーバーライドに更新することで、*読み取り専用ウォーターマーク オーバーライドが低い* というアラートを解決できます。ただし、1 つ以上のストレージ ノードが満杯に近い場合、または特別な ILM 要件がある場合は、まず最適化されたストレージ ウォーターマークを表示し、使用しても安全かどうかを判断する必要があります。



=== グリッド全体のオブジェクトデータの使用状況を評価する

.手順
. 「NODES」を選択します。
. グリッド内の各サイトについて、ノードのリストを展開します。
. 各サイトの各ストレージ ノードの *使用されたオブジェクト データ* 列に表示されるパーセンテージ値を確認します。
+
image::../media/nodes_page_object_data_used_with_alert.png[3つのSNで使用されるオブジェクトデータを表示するノードページ]

. 適切な手順に従ってください。
+
.. どのストレージ ノードも満杯に近づいていない場合 (たとえば、すべての *オブジェクト データ使用率* の値が 80% 未満の場合)、オーバーライド設定の使用を開始できます。へ移動<<use-optimized-watermarks,最適化された透かしを使用する>>。
.. ILMルールが厳密な取り込み動作を使用している場合、または特定のストレージプールが満杯に近い場合は、以下の手順を実行します。<<view-optimized-watermarks,最適化されたストレージのウォーターマークを表示する>>そして<<determine-optimized-watermarks,最適化された透かしを使用できるかどうかを判断する>>。






=== [[view-optimized-watermarks]]最適化されたストレージウォーターマークを表示する

StorageGRID は2 つの Prometheus メトリックを使用して、ストレージ ボリュームのソフト読み取り専用ウォーターマークに対して計算された最適化された値を表示します。グリッド内の各ストレージ ノードの最適化された最小値と最大値を表示できます。

.手順
. *サポート* > *ツール* > *メトリック*を選択します。
. Prometheus セクションで、Prometheus ユーザー インターフェースにアクセスするためのリンクを選択します。
. 推奨される最小ソフト読み取り専用ウォーターマークを確認するには、次の Prometheus メトリックを入力し、[実行] を選択します。
+
`storagegrid_storage_volume_minimum_optimized_soft_readonly_watermark`

+
最後の列には、各ストレージ ノード上のすべてのストレージ ボリュームのソフト読み取り専用ウォーターマークの最小最適化値が表示されます。この値がストレージ ボリュームのソフト読み取り専用ウォーターマークのカスタム設定より大きい場合、ストレージ ノードに対して *Low read-only watermark override* アラートがトリガーされます。

. 推奨される最大のソフト読み取り専用ウォーターマークを確認するには、次の Prometheus メトリックを入力し、[実行] を選択します。
+
`storagegrid_storage_volume_maximum_optimized_soft_readonly_watermark`

+
最後の列には、各ストレージ ノード上のすべてのストレージ ボリュームのソフト読み取り専用ウォーターマークの最適化された最大値が表示されます。

. [[maximum_optimized_value]]各ストレージノードの最大最適化値をメモします。




=== [[determine-optimized-watermarks]]最適化された透かしを使用できるかどうかを判断する

.手順
. 「NODES」を選択します。
. 各オンライン ストレージ ノードに対してこれらの手順を繰り返します。
+
.. *_ストレージノード_* > *ストレージ*を選択します。
.. オブジェクト ストア テーブルまで下にスクロールします。
.. 各オブジェクト ストア (ボリューム) の *Available* 値を、そのストレージ ノードに対して記録した最大の最適化されたウォーターマークと比較します。


. 各オンラインストレージノードの少なくとも1つのボリュームに、そのノードの最大最適化ウォーターマークを超える空き容量がある場合は、<<use-optimized-watermarks,最適化された透かしを使用する>>最適化された透かしの使用を開始します。
+
それ以外の場合は、できるだけ早くグリッドを拡張してください。どちらかlink:../expand/adding-storage-volumes-to-storage-nodes.html["ストレージボリュームを追加する"]既存のノードまたはlink:../expand/adding-grid-nodes-to-existing-site-or-adding-new-site.html["新しいストレージノードを追加する"]。次に、<<use-optimized-watermarks,最適化された透かしを使用する>>透かしの設定を更新します。

. ストレージボリュームのウォーターマークにカスタム値を引き続き使用する必要がある場合は、link:../monitor/silencing-alert-notifications.html["沈黙"]またはlink:../monitor/disabling-alert-rules.html["無効にする"]*読み取り専用透かしの上書きが低い* という警告。
+

NOTE: 同じカスタム ウォーターマーク値が、すべてのストレージ ノード上のすべてのストレージ ボリュームに適用されます。ストレージ ボリュームのウォーターマークに推奨値よりも小さい値を使用すると、ノードが容量に達したときに一部のストレージ ボリュームがアクセス不能になる (自動的にマウント解除される) 可能性があります。





=== [[use-optimized-watermarks]]最適化された透かしを使用する

.手順
. *サポート* > *その他* > *ストレージのウォーターマーク* に移動します。
. *最適化された値を使用する*チェックボックスを選択します。
. *保存*を選択します。


ストレージ ノードのサイズとボリュームの相対容量に基づいて、各ストレージ ボリュームに対して最適化されたストレージ ボリューム ウォーターマーク設定が有効になるようになりました。
