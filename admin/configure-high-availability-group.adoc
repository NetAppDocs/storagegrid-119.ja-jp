---
permalink: admin/configure-high-availability-group.html 
sidebar: sidebar 
keywords: how to configure high availability group, node priority order, failover 
summary: '高可用性 (HA) グループを構成して、管理ノードまたはゲートウェイ ノード上のサービスへの高可用性アクセスを提供できます。' 
---
= 高可用性グループを構成する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
高可用性 (HA) グループを構成して、管理ノードまたはゲートウェイ ノード上のサービスへの高可用性アクセスを提供できます。

.開始する前に
* グリッドマネージャにサインインするには、link:../admin/web-browser-requirements.html["サポートされているウェブブラウザ"] 。
* あなたはlink:admin-group-permissions.html["ルートアクセス権限"]。
* HA グループで VLAN インターフェイスを使用する予定の場合は、VLAN インターフェイスを作成しておきます。見るlink:../admin/configure-vlan-interfaces.html["VLANインターフェースを構成する"] 。
* HA グループ内のノードにアクセス インターフェイスを使用する予定の場合は、インターフェイスを作成しておく必要があります。
+
** *Red Hat Enterprise Linux (ノードをインストールする前)*:link:../rhel/creating-node-configuration-files.html["ノード構成ファイルを作成する"]
** *Ubuntu または Debian (ノードをインストールする前)*:link:../ubuntu/creating-node-configuration-files.html["ノード構成ファイルを作成する"]
** *Linux (ノードのインストール後)*:link:../maintain/linux-adding-trunk-or-access-interfaces-to-node.html["Linux: ノードにトランクまたはアクセスインターフェースを追加する"]
** *VMware (ノードのインストール後)*:link:../maintain/vmware-adding-trunk-or-access-interfaces-to-node.html["VMware: ノードにトランクまたはアクセス インターフェースを追加する"]






== 高可用性グループを作成する

高可用性グループを作成するときは、1 つ以上のインターフェースを選択し、優先順位に従って整理します。次に、グループに 1 つ以上の VIP アドレスを割り当てます。

HA グループに含めるには、ゲートウェイ ノードまたは管理ノード用のインターフェイスが必要です。  HA グループは、特定のノードに対して 1 つのインターフェイスのみを使用できます。ただし、同じノードの他のインターフェイスは、他の HA グループで使用できます。



=== ウィザードにアクセスする

.手順
. *構成* > *ネットワーク* > *高可用性グループ*を選択します。
. *作成*を選択します。




=== HAグループの詳細を入力します

.手順
. HA グループに一意の名前を付けます。
. 必要に応じて、HA グループの説明を入力します。
. *続行*を選択します。




=== HAグループにインターフェースを追加する

.手順
. この HA グループに追加する 1 つ以上のインターフェースを選択します。
+
列ヘッダーを使用して行を並べ替えるか、検索語を入力してインターフェイスをより速く見つけます。

+
image::../media/ha_group_add_interfaces.png[HAグループにインターフェースを追加する]

+

NOTE: VLAN インターフェイスを作成した後、新しいインターフェイスがテーブルに表示されるまで最大 5 分間待ちます。

+
.インターフェース選択のガイドライン
** 少なくとも 1 つのインターフェースを選択する必要があります。
** ノードに対して選択できるインターフェースは 1 つだけです。
** HA グループがグリッド マネージャとテナント マネージャを含む管理ノード サービスの HA 保護用である場合は、管理ノード上のインターフェイスのみを選択します。
** HA グループが S3 クライアント トラフィックの HA 保護用である場合は、管理ノード、ゲートウェイ ノード、またはその両方のインターフェイスを選択します。
** 異なるタイプのノード上のインターフェースを選択すると、情報メモが表示されます。フェイルオーバーが発生した場合、以前アクティブだったノードによって提供されていたサービスは、新しくアクティブになったノードでは利用できなくなる可能性があることに注意してください。たとえば、バックアップ ゲートウェイ ノードは、管理ノード サービスの HA 保護を提供できません。同様に、バックアップ管理ノードは、プライマリ管理ノードが提供できるすべてのメンテナンス手順を実行することはできません。
** インターフェースを選択できない場合は、そのチェックボックスは無効になります。ツールヒントにはさらに詳しい情報が表示されます。
+
image::../media/vlan_parent_interface_tooltip.png[VLANインターフェースツールチップ]

** サブネット値またはゲートウェイが選択した別のインターフェースと競合する場合は、そのインターフェースを選択できません。
** 静的 IP アドレスがない場合、構成されたインターフェースを選択することはできません。


. *続行*を選択します。




=== 優先順位を決定する

HA グループに複数のインターフェイスが含まれている場合は、どのインターフェイスがプライマリ インターフェイスで、どのインターフェイスがバックアップ (フェイルオーバー) インターフェイスであるかを決定できます。プライマリ インターフェイスに障害が発生した場合、VIP アドレスは使用可能な最も優先度の高いインターフェイスに移動します。そのインターフェースに障害が発生した場合、VIP アドレスは利用可能な次の最も優先度の高いインターフェースに移動し、これを繰り返します。

.手順
. *優先順位*列の行をドラッグして、プライマリ インターフェイスとバックアップ インターフェイスを決定します。
+
リストの最初のインターフェースはプライマリ インターフェースです。障害が発生しない限り、プライマリ インターフェイスはアクティブ インターフェイスになります。

+
image::../media/ha_group_determine_failover.png[HAグループが優先順位を決定する]

+

TIP: HA グループがグリッド マネージャへのアクセスを提供する場合は、プライマリ管理ノード上のインターフェイスをプライマリ インターフェイスとして選択する必要があります。一部のメンテナンス手順は、プライマリ管理ノードからのみ実行できます。

. *続行*を選択します。




=== IPアドレスを入力してください

.手順
. *サブネット CIDR* フィールドで、CIDR 表記 (IPv4 アドレスの後にスラッシュとサブネットの長さ (0 ～ 32)) で VIP サブネットを指定します。
+
ネットワーク アドレスにはホスト ビットを設定しないでください。例：  `192.16.0.0/22` 。

+

NOTE: 32 ビットのプレフィックスを使用する場合、VIP ネットワーク アドレスはゲートウェイ アドレスおよび VIP アドレスとしても機能します。

+
image::../media/ha_group_select_virtual_ips.png[HAグループがVIPに入場]

. オプションとして、S3 管理クライアントまたはテナント クライアントが別のサブネットからこれらの VIP アドレスにアクセスする場合は、*ゲートウェイ IP アドレス* を入力します。ゲートウェイ アドレスは VIP サブネット内にある必要があります。
+
クライアントおよび管理者ユーザーは、このゲートウェイを使用して仮想 IP アドレスにアクセスします。

. HA グループ内のアクティブ インターフェイスに、少なくとも 1 個、最大 10 個の VIP アドレスを入力します。すべての VIP アドレスは VIP サブネット内にある必要があり、アクティブ インターフェイス上ですべてが同時にアクティブになります。
+
少なくとも 1 つの IPv4 アドレスを指定する必要があります。必要に応じて、追加の IPv4 および IPv6 アドレスを指定できます。

. *HA グループの作成* を選択し、*完了* を選択します。
+
HA グループが作成され、構成された仮想 IP アドレスを使用できるようになります。





=== 次の手順

この HA グループを負荷分散に使用する場合は、ロード バランサー エンドポイントを作成して、ポートとネットワーク プロトコルを決定し、必要な証明書を添付します。見るlink:configuring-load-balancer-endpoints.html["ロードバランサのエンドポイントを構成する"] 。



== 高可用性グループを編集する

高可用性 (HA) グループを編集して、名前や説明を変更したり、インターフェイスを追加または削除したり、優先順位を変更したり、仮想 IP アドレスを追加または更新したりできます。

たとえば、サイトまたはノードの廃止手順で選択したインターフェイスに関連付けられているノードを削除する場合は、HA グループを編集する必要がある場合があります。

.手順
. *構成* > *ネットワーク* > *高可用性グループ*を選択します。
+
高可用性グループ ページには、既存の HA グループがすべて表示されます。

. 編集する HA グループのチェックボックスを選択します。
. 更新する内容に応じて、次のいずれかを実行します。
+
** VIP アドレスを追加または削除するには、[アクション] > [仮想 IP アドレスの編集] を選択します。
** グループの名前または説明を更新したり、インターフェースを追加または削除したり、優先順位を変更したり、VIP アドレスを追加または削除したりするには、[アクション] > [HA グループの編集] を選択します。


. *仮想IPアドレスの編集*を選択した場合:
+
.. HA グループの仮想 IP アドレスを更新します。
.. *保存*を選択します。
.. *完了*を選択します。


. *HA グループの編集* を選択した場合:
+
.. 必要に応じて、グループの名前または説明を更新します。
.. 必要に応じて、チェックボックスを選択または選択解除して、インターフェースを追加または削除します。
+

NOTE: HA グループがグリッド マネージャへのアクセスを提供する場合は、プライマリ管理ノード上のインターフェイスをプライマリ インターフェイスとして選択する必要があります。一部のメンテナンス手順はプライマリ管理ノードからのみ実行できます

.. 必要に応じて、行をドラッグして、この HA グループのプライマリ インターフェイスとバックアップ インターフェイスの優先順位を変更します。
.. 必要に応じて、仮想 IP アドレスを更新します。
.. *保存*を選択し、*完了*を選択します。






== 高可用性グループを削除する

一度に 1 つ以上の高可用性 (HA) グループを削除できます。


TIP: HA グループがロードバランサーエンドポイントにバインドされている場合、その HA グループを削除することはできません。  HA グループを削除するには、そのグループを使用しているすべてのロードバランサーエンドポイントからそのグループを削除する必要があります。

クライアントの中断を防ぐには、HA グループを削除する前に、影響を受ける S3 クライアント アプリケーションを更新してください。別の IP アドレス (別の HA グループの仮想 IP アドレスや、インストール時にインターフェイスに構成された IP アドレスなど) を使用して接続するように各クライアントを更新します。

.手順
. *構成* > *ネットワーク* > *高可用性グループ*を選択します。
. 削除する各 HA グループの *ロード バランサ エンドポイント* 列を確認します。ロード バランサのエンドポイントがリストされている場合:
+
.. *構成* > *ネットワーク* > *ロードバランサーエンドポイント* に移動します。
.. エンドポイントのチェックボックスを選択します。
.. *アクション* > *エンドポイント バインディング モードの編集* を選択します。
.. バインディング モードを更新して HA グループを削除します。
.. *変更を保存*を選択します。


. ロード バランサ エンドポイントがリストされていない場合は、削除する各 HA グループのチェックボックスをオンにします。
. *アクション* > *HA グループの削除* を選択します。
. メッセージを確認し、「*HA グループの削除*」を選択して選択を確定します。
+
選択したすべての HA グループが削除されます。高可用性グループ ページに緑色の成功バナーが表示されます。


