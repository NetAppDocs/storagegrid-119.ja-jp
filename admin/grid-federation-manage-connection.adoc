---
permalink: admin/grid-federation-manage-connection.html 
sidebar: sidebar 
keywords: grid federation, edit connection, remove connection, rotate certificates 
summary: StorageGRIDシステム間のグリッド フェデレーション接続の管理には、接続の詳細の編集、証明書のローテーション、テナント権限の削除、未使用の接続の削除が含まれます。 
---
= グリッドフェデレーション接続を管理する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
StorageGRIDシステム間のグリッド フェデレーション接続の管理には、接続の詳細の編集、証明書のローテーション、テナント権限の削除、未使用の接続の削除が含まれます。

.開始する前に
* いずれかのグリッドのグリッドマネージャにサインインするには、link:../admin/web-browser-requirements.html["サポートされているウェブブラウザ"] 。
* あなたはlink:admin-group-permissions.html["ルートアクセス権限"]サインインしているグリッドの。




== [[edit_grid_fed_connection]]グリッドフェデレーション接続を編集する

接続内のいずれかのグリッドのプライマリ管理ノードにサインインすることで、グリッド フェデレーション接続を編集できます。最初のグリッドに変更を加えた後、新しい検証ファイルをダウンロードして、他のグリッドにアップロードする必要があります。


NOTE: 接続の編集中、アカウントのクローンまたはグリッド間レプリケーション要求では、既存の接続設定が引き続き使用されます。最初のグリッドに加えた編集内容はローカルに保存されますが、2 番目のグリッドにアップロードされ、保存され、テストされるまで使用されません。



=== 接続の編集を開始する

.手順
. どちらかのグリッドのプライマリ管理ノードからグリッド マネージャーにSign in。
. *NODES* を選択し、システム内の他のすべての管理ノードがオンラインであることを確認します。
+

NOTE: グリッド フェデレーション接続を編集すると、 StorageGRID は最初のグリッド上のすべての管理ノードに「候補構成」ファイルを保存しようとします。このファイルをすべての管理ノードに保存できない場合は、[*保存してテスト*] を選択すると警告メッセージが表示されます。

. *構成* > *システム* > *グリッド フェデレーション* を選択します。
. グリッド フェデレーション ページまたは特定の接続の詳細ページの *アクション* メニューを使用して、接続の詳細を編集します。見るlink:grid-federation-create-connection.html["グリッドフェデレーション接続を作成する"]何を入力するか。
+
[role="tabbed-block"]
====
.[操作]メニュー
--
.. 接続のラジオボタンを選択します。
.. *アクション* > *編集*を選択します。
.. 新しい情報を入力してください。


--
.詳細ページ
--
.. 接続名を選択すると、その詳細が表示されます。
.. *編集*を選択します。
.. 新しい情報を入力してください。


--
====
. サインインしているグリッドのプロビジョニング パスフレーズを入力します。
. *保存して続行*を選択します。
+
新しい値は保存されますが、他のグリッドに新しい検証ファイルをアップロードするまで、接続には適用されません。

. *確認ファイルのダウンロード*を選択します。
+
このファイルを後でダウンロードするには、接続の詳細ページに移動します。

. ダウンロードしたファイルを見つける(`_connection-name_.grid-federation`）を作成し、安全な場所に保存します。
+

CAUTION: 検証ファイルには秘密が含まれているため、安全に保存および送信する必要があります。

. *閉じる* を選択して、グリッド フェデレーション ページに戻ります。
. *接続ステータス*が*編集保留中*であることを確認します。
+

NOTE: 接続の編集を開始したときに接続ステータスが *接続済み* 以外だった場合、*編集保留中* には変更されません。

. 提供する `_connection-name_.grid-federation`他のグリッドのグリッド管理者にファイルを送信します。




=== 接続の編集を完了する

他のグリッドに検証ファイルをアップロードして、接続の編集を完了します。

.手順
. プライマリ管理ノードからグリッド マネージャーにSign in。
. *構成* > *システム* > *グリッド フェデレーション* を選択します。
. アップロード ページにアクセスするには、[*検証ファイルのアップロード*] を選択します。
. *確認ファイルのアップロード*を選択します。次に、最初のグリッドからダウンロードしたファイルを参照して選択します。
. 現在サインインしているグリッドのプロビジョニング パスフレーズを入力します。
. *保存してテスト*を選択します。
+
編集した値を使用して接続を確立できる場合は、成功メッセージが表示されます。それ以外の場合は、エラー メッセージが表示されます。メッセージを確認し、問題があれば対処してください。

. ウィザードを閉じて、グリッド フェデレーション ページに戻ります。
. *接続ステータス*が*接続済み*であることを確認します。
. 最初のグリッドのグリッド フェデレーション ページに移動し、ブラウザーを更新します。  *接続ステータス*が*接続済み*になっていることを確認します。
. 接続が確立されたら、検証ファイルのすべてのコピーを安全に削除します。




== [[test_grid_fed_connection]]グリッドフェデレーション接続をテストする

.手順
. プライマリ管理ノードからグリッド マネージャーにSign in。
. *構成* > *システム* > *グリッド フェデレーション* を選択します。
. グリッド フェデレーション ページまたは特定の接続の詳細ページの *アクション* メニューを使用して接続をテストします。
+
[role="tabbed-block"]
====
.[操作]メニュー
--
.. 接続のラジオボタンを選択します。
.. *アクション* > *テスト*を選択します。


--
.詳細ページ
--
.. 接続名を選択すると、その詳細が表示されます。
.. *テスト接続*を選択します。


--
====
. 接続ステータスを確認します。
+
[cols="1a,2a"]
|===
| 接続ステータス | 説明 


 a| 
接続済み
 a| 
両方のグリッドは接続されており、正常に通信しています。



 a| 
エラー
 a| 
接続がエラー状態です。たとえば、証明書の有効期限が切れているか、構成値が有効でなくなっている場合などです。



 a| 
編集保留中
 a| 
このグリッド上の接続を編集しましたが、接続では既存の構成がまだ使用されています。編集を完了するには、新しい検証ファイルを他のグリッドにアップロードします。



 a| 
接続を待っています
 a| 
このグリッドでは接続を構成しましたが、他のグリッドでは接続が完了していません。このグリッドから検証ファイルをダウンロードし、他のグリッドにアップロードします。



 a| 
不明
 a| 
接続は不明な状態です。ネットワークの問題またはオフライン ノードが原因である可能性があります。

|===
. 接続ステータスが「*エラー*」の場合は、問題を解決してください。次に、*接続テスト*をもう一度選択して、問題が修正されたことを確認します。




== [[rotate_grid_fed_certificates]]接続証明書のローテーション

各グリッド フェデレーション接続では、接続を保護するために、自動的に生成された 4 つの SSL 証明書が使用されます。各グリッドの 2 つの証明書の有効期限が近づくと、「グリッド フェデレーション証明書の有効期限」アラートが表示され、証明書をローテーションするように通知されます。


CAUTION: 接続のいずれかの端の証明書の有効期限が切れると、接続は機能しなくなり、証明書が更新されるまでレプリケーションは保留になります。

.手順
. どちらかのグリッドのプライマリ管理ノードからグリッド マネージャーにSign in。
. *構成* > *システム* > *グリッド フェデレーション* を選択します。
. グリッド フェデレーション ページのいずれかのタブから、接続名を選択して詳細を表示します。
. *証明書*タブを選択します。
. *証明書のローテーション*を選択します。
. 新しい証明書の有効期間を日数指定します。
. サインインしているグリッドのプロビジョニング パスフレーズを入力します。
. *証明書のローテーション*を選択します。
. 必要に応じて、接続内の他のグリッドでこれらの手順を繰り返します。
+
一般に、接続の両側の証明書には同じ日数を使用します。





== [[remove_grid_fed_connection]]グリッドフェデレーション接続を削除する

接続内のいずれかのグリッドからグリッド フェデレーション接続を削除できます。図に示すように、両方のグリッドで前提条件の手順を実行し、どちらのグリッドのどのテナントでも接続が使用されていないことを確認する必要があります。

image::../media/grid-federation-remove-connection.png[グリッドフェデレーション接続を削除する手順]

接続を削除する前に、次の点に注意してください。

* 接続を削除しても、グリッド間で既にコピーされている項目は削除されません。たとえば、テナントの権限が削除されても、両方のグリッドに存在するテナント ユーザー、グループ、およびオブジェクトはどちらのグリッドからも削除されません。これらの項目を削除する場合は、両方のグリッドから手動で削除する必要があります。
* 接続を削除すると、レプリケーションが保留中のオブジェクト (取り込まれたが、他のグリッドにまだレプリケートされていないオブジェクト) のレプリケーションは永続的に失敗します。




=== すべてのテナントバケットのレプリケーションを無効にする

.手順
. どちらのグリッドから開始しても、プライマリ管理ノードからグリッド マネージャーにサインインします。
. *構成* > *システム* > *グリッド フェデレーション* を選択します。
. 接続名を選択すると、その詳細が表示されます。
. *許可されたテナント*タブで、接続がいずれかのテナントによって使用されているかどうかを確認します。
. テナントがリストされている場合は、すべてのテナントに指示してください。link:../tenant/grid-federation-manage-cross-grid-replication.html["クロスグリッドレプリケーションを無効にする"]接続内の両方のグリッド上のすべてのバケットに対して。
+

TIP: いずれかのテナント バケットでクロス グリッド レプリケーションが有効になっている場合は、*グリッド フェデレーション接続の使用* 権限を削除することはできません。各テナント アカウントは、両方のグリッド上のバケットのグリッド間レプリケーションを無効にする必要があります。





=== 各テナントの権限を削除する

すべてのテナント バケットに対してグリッド間レプリケーションが無効になった後、両方のグリッドのすべてのテナントから *グリッド フェデレーションの使用権限* を削除します。

.手順
. *構成* > *システム* > *グリッド フェデレーション* を選択します。
. 接続名を選択すると、その詳細が表示されます。
. *許可されたテナント*タブの各テナントについて、各テナントから*グリッド フェデレーション接続の使用*権限を削除します。見るlink:grid-federation-manage-tenants.html["許可されたテナントを管理する"] 。
. 他のグリッド上の許可されたテナントに対しても、これらの手順を繰り返します。




=== 接続を削除

.手順
. どちらのグリッドでもテナントが接続を使用していない場合は、[削除] を選択します。
. 確認メッセージを確認し、[削除] を選択します。
+
** 接続を削除できる場合は、成功メッセージが表示されます。グリッド フェデレーション接続は両方のグリッドから削除されました。
** 接続を削除できない場合 (たとえば、まだ使用中であるか、接続エラーが発生している) は、エラー メッセージが表示されます。次のいずれかを実行できます。
+
*** エラーを解決します (推奨)。見るlink:grid-federation-troubleshoot.html["グリッドフェデレーションエラーのトラブルシューティング"] 。
*** 強制的に接続を解除します。次のセクションを参照してください。








== [[force-remove_grid_fed_connection]]グリッドフェデレーション接続を強制的に削除する

必要に応じて、「接続済み」ステータスになっていない接続を強制的に削除できます。

強制削除では、ローカル グリッドからの接続のみが削除されます。接続を完全に削除するには、両方のグリッドで同じ手順を実行します。

.手順
. 確認ダイアログボックスから*強制削除*を選択します。
+
成功メッセージが表示されます。このグリッド フェデレーション接続は使用できなくなりました。ただし、テナント バケットではグリッド間レプリケーションがまだ有効になっている可能性があり、一部のオブジェクト コピーが接続内のグリッド間ですでにレプリケートされている可能性があります。

. 接続内の他のグリッドで、プライマリ管理ノードからグリッド マネージャーにサインインします。
. *構成* > *システム* > *グリッド フェデレーション* を選択します。
. 接続名を選択すると、その詳細が表示されます。
. *削除*と*はい*を選択します。
. このグリッドから接続を削除するには、「*強制削除*」を選択します。

