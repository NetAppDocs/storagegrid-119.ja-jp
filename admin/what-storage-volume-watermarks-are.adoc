---
permalink: admin/what-storage-volume-watermarks-are.html 
sidebar: sidebar 
keywords: what are storage volume watermarks, storage volume soft read-only watermark, storage volume hard read-only watermark, storage volume read-write watermark 
summary: StorageGRID は、3 つのストレージ ボリューム ウォーターマークを使用して、ストレージ ノードの容量が極端に少なくなる前に、ストレージ ノードが安全に読み取り専用状態に移行されるようにし、読み取り専用状態に移行したストレージ ノードが再び読み取り/書き込み可能になるようにします。 
---
= ストレージ ボリューム ウォーターマークとは何ですか?
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
StorageGRID は、3 つのストレージ ボリューム ウォーターマークを使用して、ストレージ ノードの容量が極端に少なくなる前に、ストレージ ノードが安全に読み取り専用状態に移行されるようにし、読み取り専用状態に移行したストレージ ノードが再び読み取り/書き込み可能になるようにします。

image::../media/storage_volume_watermarks.png[ストレージボリュームのウォーターマーク]


NOTE: ストレージ ボリューム ウォーターマークは、複製および消去コード化されたオブジェクト データに使用されるスペースにのみ適用されます。ボリューム0のオブジェクトメタデータ用に予約されているスペースの詳細については、link:managing-object-metadata-storage.html["オブジェクトメタデータストレージの管理"] 。



== ソフト読み取り専用透かしとは何ですか?

*ストレージ ボリューム ソフト読み取り専用ウォーターマーク* は、オブジェクト データ用のストレージ ノードの使用可能なスペースがいっぱいになりつつあることを示す最初のウォーターマークです。

ストレージ ノード内の各ボリュームの空き容量がそのボリュームのソフト読み取り専用ウォーターマークよりも少ない場合、ストレージ ノードは読み取り専用モードに移行します。読み取り専用モードとは、ストレージ ノードが読み取り専用サービスをStorageGRIDシステムの残りの部分に通知しますが、保留中の書き込み要求はすべて満たすことを意味します。

たとえば、ストレージ ノード内の各ボリュームに 10 GB のソフト読み取り専用ウォーターマークがあるとします。各ボリュームの空き容量が 10 GB 未満になると、ストレージ ノードはソフト読み取り専用モードに移行します。



== ハード読み取り専用透かしとは何ですか?

*ストレージ ボリューム ハード読み取り専用ウォーターマーク* は、オブジェクト データ用のノードの使用可能なスペースがいっぱいになりつつあることを示す次のウォーターマークです。

ボリュームの空き領域がそのボリュームのハード読み取り専用ウォーターマークより少ない場合、ボリュームへの書き込みは失敗します。ただし、他のボリュームへの書き込みは、それらのボリュームの空き領域がハード読み取り専用ウォーターマークよりも少なくなるまで続行できます。

たとえば、ストレージ ノード内の各ボリュームに 5 GB のハード読み取り専用ウォーターマークがあるとします。各ボリュームの空き容量が 5 GB 未満になると、ストレージ ノードは書き込み要求を受け入れなくなります。

ハード読み取り専用ウォーターマークは常にソフト読み取り専用ウォーターマークよりも小さくなります。



== 読み取り/書き込みウォーターマークとは何ですか?

*ストレージ ボリュームの読み取り/書き込みウォーターマーク* は、読み取り専用モードに移行したストレージ ノードにのみ適用されます。ノードが再び読み取り/書き込み可能になるタイミングを決定します。ストレージ ノード内のいずれかのストレージ ボリュームの空き領域がそのボリュームの読み取り/書き込みウォーターマークよりも大きい場合、ノードは自動的に読み取り/書き込み状態に戻ります。

たとえば、ストレージ ノードが読み取り専用モードに移行したとします。また、各ボリュームの読み取り/書き込みウォーターマークが 30 GB であるとします。いずれかのボリュームの空き容量が 30 GB に増加すると、ノードは再び読み取り/書き込み可能になります。

読み取り/書き込みウォーターマークは、ソフト読み取り専用ウォーターマークとハード読み取り専用ウォーターマークの両方よりも常に大きくなります。



== ストレージボリュームのウォーターマークを表示する

現在の透かし設定とシステム最適化された値を表示できます。最適化された透かしが使用されていない場合は、設定を調整できるかどうか、または調整する必要があるかどうかを判断できます。

.開始する前に
* StorageGRID 11.6 以降へのアップグレードが完了しました。
* グリッドマネージャにサインインするには、link:../admin/web-browser-requirements.html["サポートされているウェブブラウザ"] 。
* あなたはlink:admin-group-permissions.html["ルートアクセス権限"]。




=== 現在の透かし設定を表示する

グリッド マネージャーで現在のストレージ ウォーターマーク設定を表示できます。

.手順
. *サポート* > *その他* > *ストレージのウォーターマーク*を選択します。
. [ストレージ ウォーターマーク] ページで、[最適化された値を使用する] チェックボックスを確認します。
+
** チェックボックスをオンにすると、ストレージ ノードのサイズとボリュームの相対容量に基づいて、すべてのストレージ ノード上のすべてのストレージ ボリュームに対して 3 つのウォーターマークすべてが最適化されます。
+
これはデフォルトであり、推奨される設定です。これらの値を更新しないでください。オプションとして、<<view-optimized-storage-watermarks,最適化されたストレージのウォーターマークを表示する>> 。

** [最適化された値を使用する] チェックボックスが選択されていない場合は、カスタム (最適化されていない) 透かしが使用されます。カスタム透かし設定の使用はお勧めしません。指示に従ってlink:../troubleshoot/troubleshoot-low-watermark-alert.html["トラブルシューティング 読み取り専用ウォーターマークの上書き警告"]設定を調整できるかどうか、または調整する必要があるかどうかを判断します。
+
カスタム透かし設定を指定する場合は、0 より大きい値を入力する必要があります。







=== [[view-optimized-storage-watermarks]]最適化されたストレージウォーターマークを表示する

StorageGRID は2 つの Prometheus メトリックを使用して、ストレージ ボリュームのソフト読み取り専用ウォーターマークに対して計算された最適化された値を表示します。グリッド内の各ストレージ ノードの最適化された最小値と最大値を表示できます。

. *サポート* > *ツール* > *メトリック*を選択します。
. Prometheus セクションで、Prometheus ユーザー インターフェースにアクセスするためのリンクを選択します。
. 推奨される最小ソフト読み取り専用ウォーターマークを確認するには、次の Prometheus メトリックを入力し、[実行] を選択します。
+
`storagegrid_storage_volume_minimum_optimized_soft_readonly_watermark`

+
最後の列には、各ストレージ ノード上のすべてのストレージ ボリュームのソフト読み取り専用ウォーターマークの最小最適化値が表示されます。この値がストレージ ボリュームのソフト読み取り専用ウォーターマークのカスタム設定より大きい場合、ストレージ ノードに対して *Low read-only watermark override* アラートがトリガーされます。

. 推奨される最大のソフト読み取り専用ウォーターマークを確認するには、次の Prometheus メトリックを入力し、[実行] を選択します。
+
`storagegrid_storage_volume_maximum_optimized_soft_readonly_watermark`

+
最後の列には、各ストレージ ノード上のすべてのストレージ ボリュームのソフト読み取り専用ウォーターマークの最適化された最大値が表示されます。


