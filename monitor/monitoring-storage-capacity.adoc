---
permalink: monitor/monitoring-storage-capacity.html 
sidebar: sidebar 
keywords: how to monitor storage capacity 
summary: 使用可能な合計スペースを監視して、 StorageGRIDシステムのオブジェクトまたはオブジェクト メタデータのストレージ スペースが不足しないことを確認します。 
---
= ストレージ容量を監視する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
使用可能な合計スペースを監視して、 StorageGRIDシステムのオブジェクトまたはオブジェクト メタデータのストレージ スペースが不足しないことを確認します。

StorageGRID はオブジェクト データとオブジェクト メタデータを個別に保存し、オブジェクト メタデータを含む分散 Cassandra データベース用に特定の量のスペースを予約します。オブジェクトとオブジェクト メタデータに消費されるスペースの合計量と、それぞれの消費されるスペース量の傾向を監視します。これにより、ノードの追加を事前に計画し、サービスの停止を回避することができます。

あなたはできるlink:viewing-storage-tab.html["ストレージ容量情報を表示する"]グリッド全体、各サイト、およびStorageGRIDシステム内の各ストレージ ノードに対して。



== グリッド全体のストレージ容量を監視する

グリッドの全体的なストレージ容量を監視して、オブジェクト データとオブジェクト メタデータに十分な空き領域が残っていることを確認します。ストレージ容量が時間の経過とともにどのように変化するかを理解しておくと、グリッドの使用可能なストレージ容量が消費される前に、ストレージ ノードまたはストレージ ボリュームを追加する計画を立てるのに役立ちます。

グリッド マネージャー ダッシュボードを使用すると、グリッド全体および各データ センターで使用可能なストレージの容量を簡単に評価できます。ノード ページには、オブジェクト データとオブジェクト メタデータのより詳細な値が提供されます。

.手順
. グリッド全体および各データセンターで使用可能なストレージの量を評価します。
+
.. *ダッシュボード > 概要*を選択します。
.. データ領域使用量の内訳カードとメタデータ許容領域使用量の内訳カードの値をメモします。各カードには、ストレージの使用率、使用済みスペースの容量、およびサイトごとに使用可能または許可されている合計スペースがリストされます。
+

NOTE: 概要にはアーカイブ メディアは含まれません。

+
image::../media/dashboard_data_and_metadata_space_usage_breakdown.png[データとメタデータのスペース使用量の内訳]

.. ストレージの経時変化カードのグラフに注目してください。期間ドロップダウンを使用すると、ストレージが消費される速度を判断するのに役立ちます。
+
image::../media/dashboard_storage_over_time.png[ストレージの経時変化チャート]



. 使用されたストレージの量と、オブジェクト データおよびオブジェクト メタデータ用にグリッド上で使用可能なストレージの量に関する詳細情報を確認するには、[ノード] ページを使用します。
+
.. 「NODES」を選択します。
.. *_grid_* > *ストレージ*を選択します。
+
image::../media/nodes_deployment_storage_tab.png[ノードのデプロイメントストレージタブ]

.. *使用済みストレージ - オブジェクト データ* と *使用済みストレージ - オブジェクト メタデータ* のチャートの上にカーソルを置くと、グリッド全体で使用可能なオブジェクト ストレージとオブジェクト メタデータ ストレージの量、および時間の経過に伴う使用量が表示されます。
+

NOTE: サイトまたはグリッドの合計値には、オフライン ノードなど、少なくとも 5 分間メトリックを報告していないノードは含まれません。



. グリッドの使用可能なストレージ容量が消費される前に、ストレージ ノードまたはストレージ ボリュームを追加する拡張を実行することを計画します。
+
拡張のタイミングを計画するときは、追加のストレージの調達とインストールにどれくらいの時間がかかるかを考慮してください。

+

NOTE: ILM ポリシーで消去コーディングを使用する場合は、既存のストレージ ノードが約 70% 使用されたときに拡張して、追加する必要があるノードの数を減らすことをお勧めします。

+
ストレージ拡張の計画の詳細については、link:../expand/index.html["StorageGRIDの拡張手順"] 。





== 各ストレージノードのストレージ容量を監視する

各ストレージ ノードの合計使用可能スペースを監視して、ノードに新しいオブジェクト データ用の十分なスペースがあることを確認します。

.タスク概要
使用可能スペースとは、オブジェクトを保存するために使用できるストレージスペースの量です。ストレージ ノードの合計使用可能スペースは、ノード内のすべてのオブジェクト ストアの使用可能スペースを合計して計算されます。

image::../media/calculating_watermarks.gif[総使用可能スペースの概念図]

.手順
. *NODES* > *_Storage Node_* > *Storage* を選択します。
+
ノードのグラフと表が表示されます。

. 使用済みストレージ - オブジェクト データ グラフの上にカーソルを置きます。
+
次の値が表示されます。

+
** *使用済み (%)*: オブジェクト データに使用されている合計使用可能スペースの割合。
** *使用済み*: オブジェクト データに使用されている合計使用可能スペースの量。
** *複製されたデータ*: このノード、サイト、またはグリッド上の複製されたオブジェクト データの量の推定値。
** *消去コード化データ*: このノード、サイト、またはグリッド上の消去コード化オブジェクト データの量の推定値。
** *合計*: このノード、サイト、またはグリッド上の使用可能なスペースの合計量。使用価値は `storagegrid_storage_utilization_data_bytes`メトリック。
+
image::../media/nodes_page_storage_used_object_data.png[ノードページストレージ使用オブジェクトデータ]



. グラフの下のボリュームとオブジェクト ストアのテーブルで利用可能な値を確認します。
+

NOTE: これらの値のグラフを表示するには、グラフアイコンをクリックします。image:../media/icon_chart_new_for_11_5.png["チャートアイコン"] [利用可能] 列に表示されます。

+
image::../media/nodes_page_storage_tables.png[オブジェクトストアテーブル]

. 時間の経過に伴う値を監視して、使用可能なストレージ領域の消費率を推定します。
. 正常なシステム操作を維持するには、使用可能なスペースが消費される前に、ストレージ ノードを追加したり、ストレージ ボリュームを追加したり、オブジェクト データをアーカイブしたりします。
+
拡張のタイミングを計画するときは、追加のストレージの調達とインストールにどれくらいの時間がかかるかを考慮してください。

+

NOTE: ILM ポリシーで消去コーディングを使用する場合は、既存のストレージ ノードが約 70% 使用されたときに拡張して、追加する必要があるノードの数を減らすことをお勧めします。

+
ストレージ拡張の計画の詳細については、link:../expand/index.html["StorageGRIDの拡張手順"] 。

+
そのlink:../troubleshoot/troubleshooting-low-object-data-storage-alert.html["低オブジェクトデータストレージ"]ストレージ ノードにオブジェクト データを保存するのに十分なスペースが残っていない場合にアラートがトリガーされます。





== 各ストレージノードのオブジェクトメタデータ容量を監視する

各ストレージ ノードのメタデータの使用状況を監視し、重要なデータベース操作に十分なスペースが確保されていることを確認します。オブジェクト メタデータが許可されたメタデータ領域の 100% を超える前に、各サイトに新しいストレージ ノードを追加する必要があります。

.タスク概要
StorageGRID は、冗長性を提供し、オブジェクト メタデータの損失を防ぐために、各サイトでオブジェクト メタデータのコピーを 3 つ保持します。  3 つのコピーは、各ストレージ ノードのストレージ ボリューム 0 上のメタデータ用に予約されているスペースを使用して、各サイトのすべてのストレージ ノードに均等に分散されます。

場合によっては、グリッドのオブジェクト メタデータ容量がオブジェクト ストレージ容量よりも早く消費されることがあります。たとえば、通常、多数の小さなオブジェクトを取り込む場合、十分なオブジェクト ストレージ容量が残っていても、メタデータ容量を増やすためにストレージ ノードを追加する必要がある場合があります。

メタデータの使用量を増やす要因としては、ユーザー メタデータとタグのサイズと量、マルチパート アップロードのパートの合計数、ILM ストレージの場所の変更頻度などが挙げられます。

.手順
. *NODES* > *_Storage Node_* > *Storage* を選択します。
. 特定の時間の値を表示するには、「使用済みストレージ - オブジェクト メタデータ」グラフの上にカーソルを置きます。
+
image::../media/storage_used_object_metadata.png[使用済みストレージ - オブジェクトメタデータ]

+
使用済み（%）:: このストレージ ノードで使用されている、許可されたメタデータ領域の割合。
+
--
Prometheus メトリック: `storagegrid_storage_utilization_metadata_bytes`そして `storagegrid_storage_utilization_metadata_allowed_bytes`

--
使用済み:: このストレージ ノードで使用されている許可されたメタデータ領域のバイト数。
+
--
Prometheus メトリック: `storagegrid_storage_utilization_metadata_bytes`

--
許容:: このストレージ ノード上のオブジェクト メタデータに許可されるスペース。各ストレージノードでこの値がどのように決定されるかについては、link:../admin/managing-object-metadata-storage.html#allowed-metadata-space["許可されたメタデータスペースの完全な説明"] 。
+
--
Prometheus メトリック: `storagegrid_storage_utilization_metadata_allowed_bytes`

--
実際の予約:: このストレージ ノード上のメタデータ用に予約されている実際のスペース。必須のメタデータ操作に許可されたスペースと必要なスペースが含まれます。各ストレージノードのこの値がどのように計算されるかについては、link:../admin/managing-object-metadata-storage.html#actual-reserved-space-for-metadata["メタデータ用に実際に予約されているスペースの完全な説明"] 。
+
--
_Prometheus メトリックは将来のリリースで追加される予定です。_

--


+

NOTE: サイトまたはグリッドの合計値には、オフライン ノードなど、少なくとも 5 分間メトリックを報告していないノードは含まれません。

. *使用率 (%)* の値が 70% 以上の場合は、各サイトにストレージ ノードを追加してStorageGRIDシステムを拡張します。
+

CAUTION: *メタデータ ストレージ不足* アラートは、*使用済み (%)* 値が特定のしきい値に達するとトリガーされます。オブジェクト メタデータが許可されたスペースの 100% を超えるスペースを使用すると、望ましくない結果が発生する可能性があります。

+
新しいノードを追加すると、システムはサイト内のすべてのストレージ ノード間でオブジェクト メタデータを自動的に再調整します。参照link:../expand/index.html["StorageGRIDシステムを拡張するための手順"]。





== スペース使用予測を監視する

ユーザーデータとメタデータのスペース使用量予測を監視して、いつ必要になるかを予測します。link:../expand/index.html["グリッドを展開する"] 。

消費率が時間の経過とともに変化することに気付いた場合は、[平均期間] プルダウンからより短い範囲を選択して、最新の取り込みパターンのみを反映させます。季節的なパターンに気付いた場合は、より長い範囲を選択します。

新しいStorageGRIDをインストールしている場合は、スペース使用量の予測を評価する前に、データとメタデータを蓄積してください。

.手順
. ダッシュボードで、[*ストレージ*]を選択します。
. ダッシュボード カード、ストレージ プール別のデータ使用量の予測、サイト別のメタデータ使用量の予測を表示します。
. これらの値を使用して、データおよびメタデータのストレージ用に新しいストレージ ノードを追加する必要がある時期を見積もってください。


image::../media/forecast-metadata-usage.png[サイト別のメタデータ使用量の予測]
