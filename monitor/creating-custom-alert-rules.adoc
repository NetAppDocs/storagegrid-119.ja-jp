---
permalink: monitor/creating-custom-alert-rules.html 
sidebar: sidebar 
keywords: how to create custom alert rules 
summary: カスタムアラートルールを作成して、アラートをトリガーするための独自の条件を定義できます。 
---
= カスタムアラートルールを作成する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
カスタムアラートルールを作成して、アラートをトリガーするための独自の条件を定義できます。

.開始する前に
* グリッドマネージャにサインインするには、link:../admin/web-browser-requirements.html["サポートされているウェブブラウザ"] 。
* あなたはlink:../admin/admin-group-permissions.html["アラートまたはルートアクセス権限を管理する"]。
* あなたはlink:commonly-used-prometheus-metrics.html["よく使われるPrometheusメトリクス"]。
* あなたは理解している https://prometheus.io/docs/prometheus/latest/querying/basics/["Prometheusクエリの構文"^]。
* オプションとして、ビデオを視聴しました: https://netapp.hosted.panopto.com/Panopto/Pages/Viewer.aspx?id=54af90c4-9a38-4136-9621-b1ff008604a3["ビデオ: カスタムアラート"^] 。
+
[link=https://netapp.hosted.panopto.com/Panopto/Pages/Viewer.aspx?id=54af90c4-9a38-4136-9621-b1ff008604a3]
image::../media/video-screenshot-alert-create-custom-118.png[ビデオ: カスタムアラート]



.タスク概要
StorageGRID はカスタムアラートを検証しません。カスタムアラートルールを作成する場合は、次の一般的なガイドラインに従ってください。

* デフォルトのアラート ルールの条件を確認し、それをカスタム アラート ルールの例として使用します。
* アラート ルールに複数の条件を定義する場合は、すべての条件に同じ式を使用します。次に、各条件のしきい値を変更します。
* 各条件にタイプミスや論理エラーがないか注意深く確認してください。
* グリッド管理 API にリストされているメトリックのみを使用します。
* Grid Management API を使用して式をテストする場合、「成功」応答が空の応答本文 (アラートがトリガーされない) になる可能性があることに注意してください。アラートが実際にトリガーされるかどうかを確認するには、現時点で当てはまると予想される値にしきい値を一時的に設定できます。
+
例えば、次の式をテストするには `node_memory_MemTotal_bytes < 24000000000`、まず実行 `node_memory_MemTotal_bytes >= 0`期待どおりの結果が得られたことを確認します (すべてのノードが値を返します)。次に、演算子としきい値を意図した値に戻して再度実行します。結果がない場合は、この表現に現在アラートがないことを示します。

* アラートが予期したとおりにトリガーされることを検証しない限り、カスタム アラートが機能していると想定しないでください。


.手順
. *アラート* > *ルール*を選択します。
+
アラート ルール ページが表示されます。

. *カスタムルールの作成*を選択します。
+
[カスタム ルールの作成] ダイアログ ボックスが表示されます。

+
image::../media/alerts_create_custom_rule.png[アラート > カスタムルールの作成]

. このアラート ルールが現在有効になっているかどうかを確認するには、[*有効*] チェックボックスをオンにするかオフにします。
+
アラート ルールが無効になっている場合、その式は評価されず、アラートはトリガーされません。

. 次の情報を入力してください。
+
[cols="1a,2a"]
|===
| フィールド | 説明 


 a| 
一意の名前
 a| 
このルールの一意の名前。アラート ルール名は [アラート] ページに表示され、電子メール通知の件名にもなります。アラート ルールの名前は 1 〜 64 文字まで使用できます。



 a| 
説明
 a| 
発生している問題の説明。説明は、アラート ページおよび電子メール通知に表示されるアラート メッセージです。アラート ルールの説明は 1 〜 128 文字まで入力できます。



 a| 
推奨される対処方法
 a| 
オプションで、このアラートがトリガーされたときに実行する推奨アクション。推奨アクションをプレーンテキスト（書式コードなし）として入力します。アラート ルールの推奨アクションは、0 〜 1,024 文字まで指定できます。

|===
. 条件セクションで、1 つ以上のアラート重大度レベルに対して Prometheus 式を入力します。
+
基本的な表現は通常、次の形式になります。

+
`[metric] [operator] [value]`

+
式の長さは任意ですが、ユーザー インターフェイスでは 1 行に表示されます。少なくとも 1 つの式が必要です。

+
この式により、ノードにインストールされている RAM の量が 24,000,000,000 バイト (24 GB) 未満の場合にアラートがトリガーされます。

+
`node_memory_MemTotal_bytes < 24000000000`

+
利用可能なメトリクスを確認し、Prometheus式をテストするには、ヘルプアイコンを選択してくださいimage:../media/icon_nms_question.png["疑問符アイコン"]グリッド管理 API のメトリック セクションへのリンクをたどります。

. *期間* フィールドに、アラートがトリガーされるまでに条件が継続的に有効である必要がある時間を入力し、時間の単位を選択します。
+
条件が真になったときにすぐにアラートをトリガーするには、「*0*」と入力します。一時的な状況によってアラートがトリガーされるのを防ぐには、この値を増やします。

+
デフォルトは5分です。

. *保存*を選択します。
+
ダイアログ ボックスが閉じ、新しいカスタム アラート ルールが [アラート ルール] テーブルに表示されます。


