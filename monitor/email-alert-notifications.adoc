---
permalink: monitor/email-alert-notifications.html 
sidebar: sidebar 
keywords: how to disable alert rules, how to remove a custom alert rule 
summary: アラートが発生したときに電子メール通知を送信する場合は、SMTP サーバーに関する情報を提供する必要があります。アラート通知の受信者の電子メール アドレスも入力する必要があります。 
---
= アラートのメール通知を設定する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
アラートが発生したときに電子メール通知を送信する場合は、SMTP サーバーに関する情報を提供する必要があります。アラート通知の受信者の電子メール アドレスも入力する必要があります。

.開始する前に
* グリッドマネージャにサインインするには、link:../admin/web-browser-requirements.html["サポートされているウェブブラウザ"] 。
* あなたはlink:../admin/admin-group-permissions.html["アラートまたはルートアクセス権限を管理する"]。


.タスク概要
アラート通知に使用される電子メール設定は、 AutoSupportパッケージでは使用されません。ただし、すべての通知に同じ電子メール サーバーを使用することができます。

StorageGRID の展開に複数の管理ノードが含まれている場合、プライマリ管理ノードがアラート通知、 AutoSupportパッケージ、SNMP トラップおよびインフォームの優先送信元になります。プライマリ管理ノードが利用できなくなった場合、通知は他の管理ノードによって一時的に送信されます。見るlink:../primer/what-admin-node-is.html["管理ノードとは何ですか?"] 。

.手順
. *アラート* > *電子メール設定*を選択します。
+
電子メール設定ページが表示されます。

. アラートが設定されたしきい値に達したときに通知メールを送信するように指定するには、[*電子メール通知を有効にする*] チェックボックスをオンにします。
+
電子メール (SMTP) サーバー、トランスポート層セキュリティ (TLS)、電子メール アドレス、およびフィルターのセクションが表示されます。

. [電子メール (SMTP) サーバー] セクションで、 StorageGRID がSMTP サーバーにアクセスするために必要な情報を入力します。
+
SMTP サーバーで認証が必要な場合は、ユーザー名とパスワードの両方を入力する必要があります。

+
[cols="1a,2a"]
|===
| フィールド | 入力 


 a| 
メール サーバ
 a| 
SMTPサーバの完全修飾ドメイン名（FQDN）またはIPアドレス。



 a| 
ポート
 a| 
SMTP サーバーにアクセスするために使用されるポート。  1 〜 65535 の範囲で指定する必要があります。



 a| 
ユーザー名（オプション）
 a| 
SMTP サーバーで認証が必要な場合は、認証に使用するユーザー名を入力します。



 a| 
パスワード（オプション）
 a| 
SMTP サーバーで認証が必要な場合は、認証に使用するパスワードを入力します。

|===
. [電子メール アドレス] セクションで、送信者と各受信者の電子メール アドレスを入力します。
+
.. *送信者メール アドレス* には、アラート通知の送信元アドレスとして使用する有効なメール アドレスを指定します。
+
例：  `storagegrid-alerts@example.com`

.. [受信者] セクションで、アラートが発生したときに電子メールを受信する必要がある各電子メール リストまたはユーザーの電子メール アドレスを入力します。
+
プラスアイコンを選択image:../media/icon_plus_sign_black_on_white.gif["プラスアイコン"]受信者を追加します。



. SMTP サーバーとの通信にトランスポート層セキュリティ (TLS) が必要な場合は、トランスポート層セキュリティ (TLS) セクションで *TLS が必要* を選択します。
+
.. *CA 証明書* フィールドに、SMTP サーバーの ID を確認するために使用される CA 証明書を入力します。
+
このフィールドに内容をコピーして貼り付けるか、「参照」を選択してファイルを選択することもできます。

+
各中間発行証明機関 (CA) からの証明書が含まれる単一のファイルを提供する必要があります。このファイルには、PEM でエンコードされた各 CA 証明書ファイルが、証明書チェーンの順序で連結されて含まれている必要があります。

.. SMTP 電子メール サーバーで電子メールの送信者に認証用のクライアント証明書の提供を要求する場合は、[*クライアント証明書の送信*] チェックボックスをオンにします。
.. *クライアント証明書* フィールドに、SMTP サーバーに送信する PEM エンコードされたクライアント証明書を入力します。
+
このフィールドに内容をコピーして貼り付けるか、「参照」を選択してファイルを選択することもできます。

.. *秘密鍵* フィールドに、暗号化されていない PEM エンコードでクライアント証明書の秘密鍵を入力します。
+
このフィールドに内容をコピーして貼り付けるか、「参照」を選択してファイルを選択することもできます。

+

NOTE: メール設定を編集する必要がある場合は、鉛筆アイコンを選択してくださいimage:../media/icon_edit_tm.png["編集アイコン"]このフィールドを更新します。



. [フィルター] セクションで、特定のアラートのルールが無効にされていない限り、電子メール通知を生成するアラート重大度レベルを選択します。
+
[cols="1a,2a"]
|===
| 重大度 | 説明 


 a| 
軽微、重大、重大
 a| 
アラート ルールのマイナー、メジャー、またはクリティカル条件が満たされると、電子メール通知が送信されます。



 a| 
重大、重篤
 a| 
アラート ルールの主要な条件または重大な条件が満たされると、電子メール通知が送信されます。軽微なアラートについては通知は送信されません。



 a| 
クリティカルのみ
 a| 
アラート ルールの重大な条件が満たされた場合にのみ、電子メール通知が送信されます。マイナーアラートまたはメジャーアラートの場合、通知は送信されません。

|===
. 電子メール設定をテストする準備ができたら、次の手順を実行します。
+
.. *テストメールを送信*を選択します。
+
テストメールが送信されたことを示す確認メッセージが表示されます。

.. すべてのメール受信者の受信トレイを確認し、テストメールが受信されたことを確認します。
+

NOTE: 数分以内にメールが届かない場合、または*メール通知失敗*アラートがトリガーされた場合は、設定を確認して再試行してください。

.. 他の管理ノードにSign in、テストメールを送信して、すべてのサイトからの接続を確認します。
+

NOTE: アラート通知をテストするときは、すべての管理ノードにサインインして接続を確認する必要があります。これは、すべての管理ノードがテスト メールを送信するAutoSupportパッケージのテストとは対照的です。



. *保存*を選択します。
+
テストメールを送信しても設定は保存されません。  *保存*を選択する必要があります。

+
メール設定が保存されました。





== アラートメール通知に含まれる情報

SMTP 電子メール サーバーを構成すると、アラート ルールがサイレンスによって抑制されていない限り、アラートがトリガーされたときに、指定された受信者に電子メール通知が送信されます。見るlink:silencing-alert-notifications.html["サイレントアラート通知"] 。

電子メール通知には次の情報が含まれます。

image::../media/alerts_email_notification.png[アラートメール通知]

[cols="1a,6a"]
|===
| 番号 | 説明 


 a| 
1
 a| 
アラートの名前と、その後にこのアラートのアクティブなインスタンスの数が表示されます。



 a| 
2
 a| 
アラートの説明。



 a| 
3
 a| 
アラートに対する推奨アクション。



 a| 
4
 a| 
アラートの各アクティブ インスタンスに関する詳細 (影響を受けるノードとサイト、アラートの重大度、アラート ルールがトリガーされた UTC 時間、影響を受けるジョブとサービスの名前など)。



 a| 
5
 a| 
通知を送信した管理ノードのホスト名。

|===


== アラートのグループ化方法

アラートがトリガーされたときに過剰な数の電子メール通知が送信されるのを防ぐために、 StorageGRID は複数のアラートを同じ通知にグループ化しようとします。

StorageGRID が電子メール通知で複数のアラートをグループ化する方法の例については、次の表を参照してください。

[cols="1a,1a"]
|===
| 動作 | 例 


 a| 
各アラート通知は、同じ名前を持つアラートにのみ適用されます。異なる名前の 2 つのアラートが同時にトリガーされた場合、 2 つの電子メール通知が送信されます。
 a| 
* アラート A は 2 つのノードで同時にトリガーされます。通知は 1 つだけ送信されます。
* アラート A はノード 1 でトリガーされ、同時にアラート B はノード 2 でトリガーされます。アラートごとに 1 つずつ、合計 2 つの通知が送信されます。




 a| 
特定のノード上の特定のアラートについては、複数の重大度のしきい値に達した場合、最も重大度の高いアラートに対してのみ通知が送信されます。
 a| 
* アラート A がトリガーされ、マイナー、メジャー、およびクリティカルのアラートしきい値に達しました。重大なアラートに対して 1 つの通知が送信されます。




 a| 
初めてアラートがトリガーされると、 StorageGRID は通知を送信する前に 2 分間待機します。その間に同じ名前の他のアラートがトリガーされた場合、 StorageGRID はすべてのアラートを初期通知にグループ化します。
 a| 
. アラート A は 08:00 にノード 1 でトリガーされます。通知は送信されません。
. アラート A は 08:01 にノード 2 でトリガーされます。通知は送信されません。
. 08:02 に、アラートの両方のインスタンスを報告する通知が送信されます。




 a| 
同じ名前の別のアラートがトリガーされた場合、 StorageGRID は新しい通知を送信する前に 10 分間待機します。新しい通知では、以前に報告されたものも含め、すべてのアクティブなアラート (現在消音されていないアラート) が報告されます。
 a| 
. アラート A は 08:00 にノード 1 でトリガーされます。  08:02に通知が送信されます。
. アラート A は 08:05 にノード 2 でトリガーされます。 2 回目の通知は 08:15 (10 分後) に送信されます。両方のノードが報告されます。




 a| 
現在、同じ名前のアラートが複数存在し、そのうちの 1 つが解決された場合、アラートが解決されたノードでアラートが再発しても、新しい通知は送信されません。
 a| 
. アラート A はノード 1 に対してトリガーされます。通知が送信されます。
. アラート A はノード 2 に対してトリガーされます。  2 番目の通知が送信されます。
. アラート A はノード 2 では解決されていますが、ノード 1 ではアクティブなままです。
. アラート A がノード 2 に対して再度トリガーされます。ノード 1 のアラートはまだアクティブであるため、新しい通知は送信されません。




 a| 
StorageGRID は、アラートのすべてのインスタンスが解決されるか、アラート ルールが無効になるまで、7 日ごとに電子メール通知を送信し続けます。
 a| 
. アラート A は 3 月 8 日にノード 1 に対してトリガーされます。通知が送信されます。
. アラート A は解決または消音されません。追加の通知は、3 月 15 日、3 月 22 日、3 月 29 日などに送信されます。


|===


== アラートメール通知のトラブルシューティング

*電子メール通知失敗*アラートがトリガーされた場合、またはテストアラート電子メール通知を受信できない場合は、次の手順に従って問題を解決してください。

.開始する前に
* グリッドマネージャにサインインするには、link:../admin/web-browser-requirements.html["サポートされているウェブブラウザ"] 。
* あなたはlink:../admin/admin-group-permissions.html["アラートまたはルートアクセス権限を管理する"]。


.手順
. 設定を確認してください。
+
.. *アラート* > *電子メール設定*を選択します。
.. 電子メール (SMTP) サーバー設定が正しいことを確認します。
.. 受信者に有効な電子メール アドレスを指定したことを確認します。


. スパムフィルターをチェックして、メールが迷惑メールフォルダに送信されていないことを確認してください。
. 送信者アドレスからのメールがブロックされていないことをメール管理者に確認してもらってください。
. 管理ノードのログ ファイルを収集し、テクニカル サポートに問い合わせてください。
+
テクニカル サポートでは、ログの情報を使用して、何が問題であったかを特定できます。たとえば、指定したサーバーに接続すると、prometheus.log ファイルにエラーが表示される場合があります。

+
見るlink:collecting-log-files-and-system-data.html["ログファイルとシステムデータを収集する"] 。


